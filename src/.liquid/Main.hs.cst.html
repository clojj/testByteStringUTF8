<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/Users/jwin/stack-projects/testByteStringUTF8/src/Main.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><span class='hs-comment'>-- {-# LANGUAGE NoMonomorphismRestriction #-}</span>
<span class=hs-linenum>  2: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--notermination"</span>           <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  3: </span>
<span class=hs-linenum>  4: </span><span class='hs-comment'>{-# LANGUAGE UnicodeSyntax #-}</span>
<span class=hs-linenum>  5: </span><span class='hs-comment'>{-# LANGUAGE OverloadedStrings #-}</span>
<span class=hs-linenum>  6: </span>
<span class=hs-linenum>  7: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>splitAt</span><span class='hs-layout'>,</span> <span class='hs-varid'>length</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldl</span><span class='hs-layout'>,</span> <span class='hs-varid'>break</span><span class='hs-layout'>,</span> <span class='hs-varid'>drop</span><span class='hs-layout'>,</span> <span class='hs-varid'>take</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  8: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-varop'>.</span><span class='hs-conid'>UTF8</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>foldr</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  9: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>B</span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Monoid</span>
<span class=hs-linenum> 11: </span>
<span class=hs-linenum> 12: </span><span class='hs-comment'>-- import Debug.Trace</span>
<span class=hs-linenum> 13: </span>
<span class=hs-linenum> 14: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Pos</span> <span class='hs-conid'>Int</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Classes.Eq Main.Pos)</span><span class='hs-conid'>Eq</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Show.Show Main.Pos)</span><span class='hs-conid'>Show</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 15: </span>
<span class=hs-linenum> 16: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Token</span>        <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conid'>Pos</span><span class='hs-layout'>,</span> <span class='hs-conid'>Pos</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>String</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 17: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Acc</span>          <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Pos</span><span class='hs-layout'>,</span> <span class='hs-conid'>ByteString</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 18: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Advancement</span>  <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 19: </span>
<span class=hs-linenum> 20: </span><span class='hs-comment'>-- TODO type Line = Int</span>
<span class=hs-linenum> 21: </span><span class='hs-comment'>-- TODO type Column = Int</span>
<span class=hs-linenum> 22: </span><span class='hs-comment'>-- TODO type Offset = Int</span>
<span class=hs-linenum> 23: </span>
<span class=hs-linenum> 24: </span><span class='hs-definition'>main</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 25: </span><a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##7498 : ()^"lq_tmp$x##7497" "lq_tmp$x##15" | $k_##7496[lq_tmp$x##7494:=Main.main##rRH][VV##7495:=lq_tmp$x##7498]})</span><span class='hs-definition'>main</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 26: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7089 : Data.ByteString.Internal.ByteString^"lq_tmp$x##7088" | $k_##7087[VV##7086:=lq_tmp$x##7089][lq_tmp$x##7071:=lq_anf$##1677728989##d1Vb][lq_tmp$x##7070:=Data.ByteString.UTF8.fromString##r3r]}</span><span class='hs-varid'>content</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7095 : lq_tmp$x##7097:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##7095 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7043 : lq_tmp$x##7047:[[GHC.Types.Char]] -&gt; [GHC.Types.Char] | lq_tmp$x##7043 == Data.OldList.unlines##r2I}</span><span class='hs-varid'>unlines</span></a>
<span class=hs-linenum> 27: </span>                <span class='hs-keyglyph'>[</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##6597 : [GHC.Types.Char] | lq_tmp$x##6597 ~~ lq_anf$##1677728970##d1US
                                     &amp;&amp; len lq_tmp$x##6597 == strLen lq_anf$##1677728970##d1US}</span><span class='hs-str'>" aaa Zeile1 end1"</span></a><span class='hs-layout'>,</span>
<span class=hs-linenum> 28: </span>                 <a class=annot href="#"><span class=annottext>{lq_tmp$x##6609 : [GHC.Types.Char] | lq_tmp$x##6609 ~~ lq_anf$##1677728972##d1UU
                                     &amp;&amp; len lq_tmp$x##6609 == strLen lq_anf$##1677728972##d1UU}</span><span class='hs-str'>"Zeile 2 Ze"</span></a><span class='hs-layout'>,</span>
<span class=hs-linenum> 29: </span>                 <a class=annot href="#"><span class=annottext>{lq_tmp$x##6621 : [GHC.Types.Char] | lq_tmp$x##6621 ~~ lq_anf$##1677728974##d1UW
                                     &amp;&amp; len lq_tmp$x##6621 == strLen lq_anf$##1677728974##d1UW}</span><span class='hs-str'>"ile3 33 333 end3"</span></a><span class='hs-layout'>,</span>
<span class=hs-linenum> 30: </span>                 <a class=annot href="#"><span class=annottext>{lq_tmp$x##6633 : [GHC.Types.Char] | lq_tmp$x##6633 ~~ lq_anf$##1677728976##d1UY
                                     &amp;&amp; len lq_tmp$x##6633 == strLen lq_anf$##1677728976##d1UY}</span><span class='hs-str'>"Zeile4 Gaaaaanz l"</span></a><span class='hs-layout'>,</span>
<span class=hs-linenum> 31: </span>                 <a class=annot href="#"><span class=annottext>{lq_tmp$x##6645 : [GHC.Types.Char] | lq_tmp$x##6645 ~~ lq_anf$##1677728978##d1V0
                                     &amp;&amp; len lq_tmp$x##6645 == strLen lq_anf$##1677728978##d1V0}</span><span class='hs-str'>"aaaanges"</span></a><span class='hs-layout'>,</span>
<span class=hs-linenum> 32: </span>                 <a class=annot href="#"><span class=annottext>{lq_tmp$x##6657 : [GHC.Types.Char] | lq_tmp$x##6657 ~~ lq_anf$##1677728980##d1V2
                                     &amp;&amp; len lq_tmp$x##6657 == strLen lq_anf$##1677728980##d1V2}</span><span class='hs-str'>" Token  ENDE"</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 33: </span>
<span class=hs-linenum> 34: </span>      <a class=annot href="#"><span class=annottext>{lq_tmp$x##6431 : [{lq_tmp$x##6490 : ({lq_tmp$x##6480 : ({lq_tmp$x##6476 : Main.Pos^"lq_tmp$x##6441" | $k_##6440[VV##6449:=lq_tmp$x##6480][VV##6473:=lq_tmp$x##6490][lq_tmp$x##6436:=lq_anf$##1677728969##d1UR][lq_tmp$x##6435:=lq_anf$##1677728913##d1TX][VV##6439:=lq_tmp$x##6476]}, {lq_tmp$x##6477 : Main.Pos^"lq_tmp$x##6444" | $k_##6443[VV##6449:=lq_tmp$x##6480][VV##6442:=lq_tmp$x##6477][VV##6473:=lq_tmp$x##6490][lq_tmp$x##6436:=lq_anf$##1677728969##d1UR][lq_tmp$x##6435:=lq_anf$##1677728913##d1TX]})^"lq_tmp$x##6451" | $k_##6450[VV##6449:=lq_tmp$x##6480][VV##6473:=lq_tmp$x##6490][lq_tmp$x##6436:=lq_anf$##1677728969##d1UR][lq_tmp$x##6435:=lq_anf$##1677728913##d1TX]}, {lq_tmp$x##6484 : [{lq_tmp$x##6481 : GHC.Types.Char^"lq_tmp$x##6454" | $k_##6453[VV##6452:=lq_tmp$x##6481][VV##6473:=lq_tmp$x##6490][VV##6459:=lq_tmp$x##6484][lq_tmp$x##6436:=lq_anf$##1677728969##d1UR][lq_tmp$x##6435:=lq_anf$##1677728913##d1TX]}]^"lq_tmp$x##6461" | $k_##6460[VV##6473:=lq_tmp$x##6490][VV##6459:=lq_tmp$x##6484][lq_tmp$x##6436:=lq_anf$##1677728969##d1UR][lq_tmp$x##6435:=lq_anf$##1677728913##d1TX]})^"lq_tmp$x##6475" | $k_##6474[VV##6473:=lq_tmp$x##6490][lq_tmp$x##6436:=lq_anf$##1677728969##d1UR][lq_tmp$x##6435:=lq_anf$##1677728913##d1TX]}] | len lq_tmp$x##6431 == 1 + len lq_anf$##1677728969##d1UR
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; (null lq_tmp$x##6431 &lt;=&gt; false)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; tail lq_tmp$x##6431 == lq_anf$##1677728969##d1UR
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; head lq_tmp$x##6431 == lq_anf$##1677728913##d1TX}</span><span class='hs-varid'>tokens</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span>
<span class=hs-linenum> 35: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4682 : lq_tmp$x##4683:GHC.Types.Int -&gt; lq_tmp$x##4684:GHC.Types.Int -&gt; {lq_tmp$x##4680 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##4680 == Main.Pos##rRG lq_tmp$x##4683 lq_tmp$x##4684} | lq_tmp$x##4682 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>2</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4704 : lq_tmp$x##4705:GHC.Types.Int -&gt; lq_tmp$x##4706:GHC.Types.Int -&gt; {lq_tmp$x##4702 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##4702 == Main.Pos##rRG lq_tmp$x##4705 lq_tmp$x##4706} | lq_tmp$x##4704 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4739 : [GHC.Types.Char] | lq_tmp$x##4739 ~~ lq_anf$##1677728911##d1TV
                                     &amp;&amp; len lq_tmp$x##4739 == strLen lq_anf$##1677728911##d1TV}</span><span class='hs-str'>"special"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 36: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4824 : lq_tmp$x##4825:GHC.Types.Int -&gt; lq_tmp$x##4826:GHC.Types.Int -&gt; {lq_tmp$x##4822 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##4822 == Main.Pos##rRG lq_tmp$x##4825 lq_tmp$x##4826} | lq_tmp$x##4824 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>2</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4846 : lq_tmp$x##4847:GHC.Types.Int -&gt; lq_tmp$x##4848:GHC.Types.Int -&gt; {lq_tmp$x##4844 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##4844 == Main.Pos##rRG lq_tmp$x##4847 lq_tmp$x##4848} | lq_tmp$x##4846 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>5</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4881 : [GHC.Types.Char] | lq_tmp$x##4881 ~~ lq_anf$##1677728921##d1U5
                                     &amp;&amp; len lq_tmp$x##4881 == strLen lq_anf$##1677728921##d1U5}</span><span class='hs-str'>"token_aaa"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 37: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4966 : lq_tmp$x##4967:GHC.Types.Int -&gt; lq_tmp$x##4968:GHC.Types.Int -&gt; {lq_tmp$x##4964 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##4964 == Main.Pos##rRG lq_tmp$x##4967 lq_tmp$x##4968} | lq_tmp$x##4966 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>6</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4988 : lq_tmp$x##4989:GHC.Types.Int -&gt; lq_tmp$x##4990:GHC.Types.Int -&gt; {lq_tmp$x##4986 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##4986 == Main.Pos##rRG lq_tmp$x##4989 lq_tmp$x##4990} | lq_tmp$x##4988 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>12</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5023 : [GHC.Types.Char] | lq_tmp$x##5023 ~~ lq_anf$##1677728931##d1Uf
                                     &amp;&amp; len lq_tmp$x##5023 == strLen lq_anf$##1677728931##d1Uf}</span><span class='hs-str'>"token_Zeile1"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 38: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5108 : lq_tmp$x##5109:GHC.Types.Int -&gt; lq_tmp$x##5110:GHC.Types.Int -&gt; {lq_tmp$x##5106 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##5106 == Main.Pos##rRG lq_tmp$x##5109 lq_tmp$x##5110} | lq_tmp$x##5108 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>2</span> <span class='hs-num'>9</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5130 : lq_tmp$x##5131:GHC.Types.Int -&gt; lq_tmp$x##5132:GHC.Types.Int -&gt; {lq_tmp$x##5128 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##5128 == Main.Pos##rRG lq_tmp$x##5131 lq_tmp$x##5132} | lq_tmp$x##5130 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>3</span> <span class='hs-num'>5</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5165 : [GHC.Types.Char] | lq_tmp$x##5165 ~~ lq_anf$##1677728941##d1Up
                                     &amp;&amp; len lq_tmp$x##5165 == strLen lq_anf$##1677728941##d1Up}</span><span class='hs-str'>"token_Zeile3"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 39: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5250 : lq_tmp$x##5251:GHC.Types.Int -&gt; lq_tmp$x##5252:GHC.Types.Int -&gt; {lq_tmp$x##5248 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##5248 == Main.Pos##rRG lq_tmp$x##5251 lq_tmp$x##5252} | lq_tmp$x##5250 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>4</span> <span class='hs-num'>8</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5272 : lq_tmp$x##5273:GHC.Types.Int -&gt; lq_tmp$x##5274:GHC.Types.Int -&gt; {lq_tmp$x##5270 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##5270 == Main.Pos##rRG lq_tmp$x##5273 lq_tmp$x##5274} | lq_tmp$x##5272 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>6</span> <span class='hs-num'>7</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5307 : [GHC.Types.Char] | lq_tmp$x##5307 ~~ lq_anf$##1677728951##d1Uz
                                     &amp;&amp; len lq_tmp$x##5307 == strLen lq_anf$##1677728951##d1Uz}</span><span class='hs-str'>"token_laaang"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 40: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5392 : lq_tmp$x##5393:GHC.Types.Int -&gt; lq_tmp$x##5394:GHC.Types.Int -&gt; {lq_tmp$x##5390 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##5390 == Main.Pos##rRG lq_tmp$x##5393 lq_tmp$x##5394} | lq_tmp$x##5392 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>6</span> <span class='hs-num'>9</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5414 : lq_tmp$x##5415:GHC.Types.Int -&gt; lq_tmp$x##5416:GHC.Types.Int -&gt; {lq_tmp$x##5412 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##5412 == Main.Pos##rRG lq_tmp$x##5415 lq_tmp$x##5416} | lq_tmp$x##5414 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>6</span> <span class='hs-num'>13</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5449 : [GHC.Types.Char] | lq_tmp$x##5449 ~~ lq_anf$##1677728961##d1UJ
                                     &amp;&amp; len lq_tmp$x##5449 == strLen lq_anf$##1677728961##d1UJ}</span><span class='hs-str'>"token_ENDE"</span></a><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 41: </span>
<span class=hs-linenum> 42: </span>      <a class=annot href="#"><span class=annottext>{lq_tmp$x##4660 : [GHC.Types.Char] | lq_tmp$x##4660 ~~ lq_anf$##1677728903##d1TN
                                     &amp;&amp; len lq_tmp$x##4660 == strLen lq_anf$##1677728903##d1TN}</span><span class='hs-varid'>expectedLines</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 43: </span>        <span class='hs-str'>"[SPAN]WS[:] [SPAN][SPAN]special[SPAN][SPAN]token_aaa[:]aaa[SPAN][SPAN]WS[:] [SPAN][SPAN]token_Zeile1[:]Zeile1[SPAN][SPAN]WS[:] end1\n\
         \Zeile 2 [SPAN][SPAN]token_Zeile3[:]Ze\n\
         \ile3[SPAN][SPAN]WS[:] 33 333 end3\n\
         \Zeile4 [SPAN][SPAN]token_laaang[:]Gaaaaanz l\n\
         \aaaanges\n\
         \ Token[SPAN][SPAN]WS[:]  [SPAN][SPAN]token_ENDE[:]ENDE[SPAN][SPAN]WS[:]\n\
         \[SPAN]"</span>
<span class=hs-linenum> 50: </span>
<span class=hs-linenum> 51: </span>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 52: </span>    <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>r</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3275:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3276:[((Main.Pos, Main.Pos), [GHC.Types.Char])] -&gt; lq_tmp$x##3277:(Main.Pos, Data.ByteString.Internal.ByteString) -&gt; (GHC.Types.IO Data.ByteString.Internal.ByteString)</span><span class='hs-varid'>loopOver</span></a> <span class='hs-varid'>content</span> <span class='hs-varid'>tokens</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##7121 : lq_tmp$x##7122:GHC.Types.Int -&gt; lq_tmp$x##7123:GHC.Types.Int -&gt; {lq_tmp$x##7119 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##7119 == Main.Pos##rRG lq_tmp$x##7122 lq_tmp$x##7123} | lq_tmp$x##7121 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>1</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>mempty</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 53: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>resultString</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7284 : lq_tmp$x##7285:Data.ByteString.Internal.ByteString -&gt; [GHC.Types.Char] | lq_tmp$x##7284 == Data.ByteString.UTF8.toString##r3j}</span><span class='hs-varid'>toString</span></a> <span class='hs-varid'>r</span>
<span class=hs-linenum> 54: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##7295 : lq_tmp$x##7297:[GHC.Types.Char] -&gt; (GHC.Types.IO ()) | lq_tmp$x##7295 == System.IO.putStrLn##r1I}</span><span class='hs-varid'>putStrLn</span></a> <span class='hs-varid'>resultString</span>
<span class=hs-linenum> 55: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##7311 : lq_tmp$x##7313:[GHC.Types.Char] -&gt; (GHC.Types.IO ()) | lq_tmp$x##7311 == System.IO.putStrLn##r1I}</span><span class='hs-varid'>putStrLn</span></a> <span class='hs-varid'>expectedLines</span>
<span class=hs-linenum> 56: </span>    <a class=annot href="#"><span class=annottext>lq_tmp$x##7327:[GHC.Types.Char] -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>print</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##7389:GHC.Types.Bool -&gt; [GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##7343 : GHC.Types.Bool | Prop lq_tmp$x##7343 &lt;=&gt; expectedLines##a1ic == resultString##a1lv}</span><span class='hs-varid'>expectedLines</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##7348:{lq_tmp$x##7363 : [{lq_tmp$x##7360 : GHC.Types.Char^"lq_tmp$x##7352" | $k_##7351[VV##7350:=lq_tmp$x##7360][lq_tmp$x##7347:=fix$36$$36$dEq_a1L1][VV##7357:=lq_tmp$x##7363]}]^"lq_tmp$x##7359" | $k_##7358[lq_tmp$x##7347:=fix$36$$36$dEq_a1L1][VV##7357:=lq_tmp$x##7363]} -&gt; lq_tmp$x##7349:{lq_tmp$x##7363 : [{lq_tmp$x##7360 : GHC.Types.Char^"lq_tmp$x##7352" | $k_##7351[VV##7350:=lq_tmp$x##7360][lq_tmp$x##7347:=fix$36$$36$dEq_a1L1][VV##7357:=lq_tmp$x##7363]}]^"lq_tmp$x##7359" | $k_##7358[lq_tmp$x##7347:=fix$36$$36$dEq_a1L1][VV##7357:=lq_tmp$x##7363]} -&gt; {lq_tmp$x##7343 : GHC.Types.Bool | Prop lq_tmp$x##7343 &lt;=&gt; lq_tmp$x##7348 == lq_tmp$x##7349}</span><span class='hs-varop'>==</span></a> <span class='hs-varid'>resultString</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 57: </span>
<span class=hs-linenum> 58: </span><span class='hs-definition'>loopOver</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Token</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Acc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 59: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##3275:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3276:[((Main.Pos, Main.Pos), [GHC.Types.Char])] -&gt; lq_tmp$x##3277:(Main.Pos, Data.ByteString.Internal.ByteString) -&gt; (GHC.Types.IO Data.ByteString.Internal.ByteString)</span><span class='hs-definition'>loopOver</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>bs</span></a> <a class=annot href="#"><span class=annottext>[((Main.Pos, Main.Pos), [GHC.Types.Char])]</span><span class='hs-varid'>tokens</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>currentPos</span><span class='hs-layout'>,</span> <span class='hs-varid'>result</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 60: </span>  <span class='hs-keyword'>case</span> <span class='hs-varid'>tokens</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 61: </span>
<span class=hs-linenum> 62: </span>    <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##75:a -&gt; (GHC.Types.IO a)</span><span class='hs-varid'>return</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>result</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3512:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3513:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sepPart</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3498:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3499:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3441 : lq_tmp$x##3443:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##3441 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3430 : [GHC.Types.Char] | lq_tmp$x##3430 ~~ lq_anf$##1677728863##d1T9
                                     &amp;&amp; len lq_tmp$x##3430 == strLen lq_anf$##1677728863##d1T9}</span><span class='hs-str'>"WS"</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3484:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3485:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sep</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3470:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3471:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>bs</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3456:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3457:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <span class='hs-varid'>sepPart</span>
<span class=hs-linenum> 63: </span>
<span class=hs-linenum> 64: </span>    <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>pos1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Pos</span> <span class='hs-varid'>l1</span> <span class='hs-varid'>c1</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>pos2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Pos</span> <span class='hs-varid'>l2</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>tname</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>tokenTail</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum> 65: </span>      <span class='hs-comment'>-- putStrLn ("currentPos " ++ show currentPos ++ " pos1 " ++ show pos1 ++ " advanceLinesAndColumns " ++ show (advanceLinesAndColumns currentPos pos1)) &gt;&gt;</span>
<span class=hs-linenum> 66: </span>
<span class=hs-linenum> 67: </span>      <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3728 : GHC.Types.Bool | Prop lq_tmp$x##3728 &lt;=&gt; currentPos##a1p1 == lq_anf$##1677728873##d1Tj}</span><span class='hs-varid'>currentPos</span></a> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq Main.Pos)</span><span class='hs-varop'>==</span></a> <span class='hs-varid'>pos1</span> <span class='hs-keyword'>then</span>
<span class=hs-linenum> 68: </span>        <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4094 : GHC.Types.Bool | Prop lq_tmp$x##4094 &lt;=&gt; lq_anf$##1677728873##d1Tj == lq_anf$##1677728874##d1Tk}</span><span class='hs-varid'>pos1</span></a> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq Main.Pos)</span><span class='hs-varop'>==</span></a> <span class='hs-varid'>pos2</span> <span class='hs-keyword'>then</span>
<span class=hs-linenum> 69: </span>          <a class=annot href="#"><span class=annottext>lq_tmp$x##3275:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3276:[((Main.Pos, Main.Pos), [GHC.Types.Char])] -&gt; lq_tmp$x##3277:(Main.Pos, Data.ByteString.Internal.ByteString) -&gt; (GHC.Types.IO Data.ByteString.Internal.ByteString)</span><span class='hs-varid'>loopOver</span></a> <span class='hs-varid'>bs</span> <span class='hs-varid'>tokenTail</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4451 : lq_tmp$x##4452:GHC.Types.Int -&gt; lq_tmp$x##4453:GHC.Types.Int -&gt; {lq_tmp$x##4449 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##4449 == Main.Pos##rRG lq_tmp$x##4452 lq_tmp$x##4453} | lq_tmp$x##4451 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-varid'>l1</span> <span class='hs-varid'>c1</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>result</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4505:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4506:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sepPart</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4491:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4492:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4462 : lq_tmp$x##4464:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##4462 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <span class='hs-varid'>tname</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4477:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4478:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <span class='hs-varid'>sepPart</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 70: </span>        <span class='hs-keyword'>else</span>
<span class=hs-linenum> 71: </span>          <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, GHC.Types.Int)</span><span class='hs-varid'>advancement</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4125 : lq_tmp$x##4126:Main.Pos -&gt; lq_tmp$x##4127:Main.Pos -&gt; (GHC.Types.Int, GHC.Types.Int) | lq_tmp$x##4125 == Main.advanceLinesAndColumns##rRJ}</span><span class='hs-varid'>advanceLinesAndColumns</span></a> <span class='hs-varid'>pos1</span> <span class='hs-varid'>pos2</span>
<span class=hs-linenum> 72: </span>              <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##4158 : Data.ByteString.Internal.ByteString^"lq_tmp$x##4160" | $k_##4159}</span><span class='hs-varid'>token</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##4184 : Data.ByteString.Internal.ByteString^"lq_tmp$x##4186" | $k_##4185}</span><span class='hs-varid'>bsTail</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4144 : lq_tmp$x##4146:(GHC.Types.Int, GHC.Types.Int) -&gt; lq_tmp$x##4147:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString) | lq_tmp$x##4144 == Main.spanAdvancement##rRM}</span><span class='hs-varid'>spanAdvancement</span></a> <span class='hs-varid'>advancement</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum> 73: </span>              <span class='hs-comment'>-- (token, bsTail) = spanLines advancement bs</span>
<span class=hs-linenum> 74: </span>          <span class='hs-keyword'>in</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3275:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3276:[((Main.Pos, Main.Pos), [GHC.Types.Char])] -&gt; lq_tmp$x##3277:(Main.Pos, Data.ByteString.Internal.ByteString) -&gt; (GHC.Types.IO Data.ByteString.Internal.ByteString)</span><span class='hs-varid'>loopOver</span></a> <span class='hs-varid'>bsTail</span> <span class='hs-varid'>tokenTail</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4214 : lq_tmp$x##4215:GHC.Types.Int -&gt; lq_tmp$x##4216:GHC.Types.Int -&gt; {lq_tmp$x##4212 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##4212 == Main.Pos##rRG lq_tmp$x##4215 lq_tmp$x##4216} | lq_tmp$x##4214 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-varid'>l2</span> <span class='hs-varid'>c2</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>result</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4296:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4297:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sepPart</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4282:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4283:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4225 : lq_tmp$x##4227:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##4225 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <span class='hs-varid'>tname</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4268:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4269:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sep</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4254:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4255:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>token</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4240:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4241:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <span class='hs-varid'>sepPart</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 75: </span>      <span class='hs-keyword'>else</span>
<span class=hs-linenum> 76: </span>        <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, GHC.Types.Int)</span><span class='hs-varid'>advancement</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3759 : lq_tmp$x##3760:Main.Pos -&gt; lq_tmp$x##3761:Main.Pos -&gt; (GHC.Types.Int, GHC.Types.Int) | lq_tmp$x##3759 == Main.advanceLinesAndColumns##rRJ}</span><span class='hs-varid'>advanceLinesAndColumns</span></a> <span class='hs-varid'>currentPos</span> <span class='hs-varid'>pos1</span>
<span class=hs-linenum> 77: </span>            <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##3792 : Data.ByteString.Internal.ByteString^"lq_tmp$x##3794" | $k_##3793}</span><span class='hs-varid'>ws</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##3818 : Data.ByteString.Internal.ByteString^"lq_tmp$x##3820" | $k_##3819}</span><span class='hs-varid'>bsTail</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3778 : lq_tmp$x##3780:(GHC.Types.Int, GHC.Types.Int) -&gt; lq_tmp$x##3781:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString) | lq_tmp$x##3778 == Main.spanAdvancement##rRM}</span><span class='hs-varid'>spanAdvancement</span></a> <span class='hs-varid'>advancement</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum> 78: </span>            <span class='hs-comment'>-- (ws, bsTail) = spanLines advancement bs</span>
<span class=hs-linenum> 79: </span>        <span class='hs-keyword'>in</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3275:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3276:[((Main.Pos, Main.Pos), [GHC.Types.Char])] -&gt; lq_tmp$x##3277:(Main.Pos, Data.ByteString.Internal.ByteString) -&gt; (GHC.Types.IO Data.ByteString.Internal.ByteString)</span><span class='hs-varid'>loopOver</span></a> <span class='hs-varid'>bsTail</span> <span class='hs-varid'>tokens</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3848 : lq_tmp$x##3849:GHC.Types.Int -&gt; lq_tmp$x##3850:GHC.Types.Int -&gt; {lq_tmp$x##3846 : Main.Pos^"lq_tmp$x##422" | lq_tmp$x##3846 == Main.Pos##rRG lq_tmp$x##3849 lq_tmp$x##3850} | lq_tmp$x##3848 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-varid'>l1</span> <span class='hs-varid'>c1</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>result</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3942:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3943:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sepPart</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3928:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3929:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3871 : lq_tmp$x##3873:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##3871 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3860 : [GHC.Types.Char] | lq_tmp$x##3860 ~~ lq_anf$##1677728878##d1To
                                     &amp;&amp; len lq_tmp$x##3860 == strLen lq_anf$##1677728878##d1To}</span><span class='hs-str'>"WS"</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3914:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3915:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sep</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3900:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3901:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>ws</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3886:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3887:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <span class='hs-varid'>sepPart</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 80: </span>
<span class=hs-linenum> 81: </span><span class='hs-definition'>advanceLinesAndColumns</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Advancement</span>
<span class=hs-linenum> 82: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2029:Main.Pos -&gt; lq_tmp$x##2030:Main.Pos -&gt; (GHC.Types.Int, GHC.Types.Int)</span><span class='hs-definition'>advanceLinesAndColumns</span></a> <a class=annot href="#"><span class=annottext>Main.Pos</span><span class='hs-varid'>p1</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Pos</span> <span class='hs-varid'>l1</span> <span class='hs-varid'>c1</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>Main.Pos</span><span class='hs-varid'>p2</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Pos</span> <span class='hs-varid'>l2</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 83: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2073 : GHC.Types.Bool | Prop lq_tmp$x##2073 &lt;=&gt; lq_anf$##1677728810##d1Si == lq_anf$##1677728811##d1Sj}</span><span class='hs-varid'>p1</span></a> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq Main.Pos)</span><span class='hs-varop'>==</span></a> <span class='hs-varid'>p2</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 84: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2121 : GHC.Types.Int^"lq_tmp$x##2120" | lq_tmp$x##2121 == l2##a1pl - l1##a1pi}</span><span class='hs-varid'>l2</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##2118:GHC.Types.Int -&gt; lq_tmp$x##2119:GHC.Types.Int -&gt; {lq_tmp$x##2121 : GHC.Types.Int^"lq_tmp$x##2120" | lq_tmp$x##2121 == lq_tmp$x##2118 - lq_tmp$x##2119}</span><span class='hs-comment'>-</span></a> <span class='hs-varid'>l1</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2139:{lq_tmp$x##2144 : GHC.Types.Int^"lq_tmp$x##2143" | $k_##2142[lq_tmp$x##2138:=GHC.Classes.$fOrdInt##rXb][VV##2141:=lq_tmp$x##2144]} -&gt; lq_tmp$x##2140:{lq_tmp$x##2144 : GHC.Types.Int^"lq_tmp$x##2143" | $k_##2142[lq_tmp$x##2138:=GHC.Classes.$fOrdInt##rXb][VV##2141:=lq_tmp$x##2144]} -&gt; {lq_tmp$x##2134 : GHC.Types.Bool | Prop lq_tmp$x##2134 &lt;=&gt; lq_tmp$x##2139 &gt; lq_tmp$x##2140}</span><span class='hs-varop'>&gt;</span></a> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2230 : GHC.Types.Int^"lq_tmp$x##2229" | lq_tmp$x##2230 == l2##a1pl - l1##a1pi}</span><span class='hs-varid'>l2</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##2227:GHC.Types.Int -&gt; lq_tmp$x##2228:GHC.Types.Int -&gt; {lq_tmp$x##2230 : GHC.Types.Int^"lq_tmp$x##2229" | lq_tmp$x##2230 == lq_tmp$x##2227 - lq_tmp$x##2228}</span><span class='hs-comment'>-</span></a> <span class='hs-varid'>l1</span><span class='hs-layout'>,</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 85: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2188 : GHC.Types.Int^"lq_tmp$x##2187" | lq_tmp$x##2188 == c2##a1pm - c1##a1pj}</span><span class='hs-varid'>c2</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##2185:GHC.Types.Int -&gt; lq_tmp$x##2186:GHC.Types.Int -&gt; {lq_tmp$x##2188 : GHC.Types.Int^"lq_tmp$x##2187" | lq_tmp$x##2188 == lq_tmp$x##2185 - lq_tmp$x##2186}</span><span class='hs-comment'>-</span></a> <span class='hs-varid'>c1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 86: </span>
<span class=hs-linenum> 87: </span><span class='hs-definition'>sep</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 88: </span><a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-definition'>sep</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1012 : lq_tmp$x##1014:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##1012 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1001 : [GHC.Types.Char] | lq_tmp$x##1001 ~~ lq_anf$##1677728788##d1RW
                                     &amp;&amp; len lq_tmp$x##1001 == strLen lq_anf$##1677728788##d1RW}</span><span class='hs-str'>"[:]"</span></a>
<span class=hs-linenum> 89: </span>
<span class=hs-linenum> 90: </span><span class='hs-definition'>sepPart</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 91: </span><a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-definition'>sepPart</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##985 : lq_tmp$x##987:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##985 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##974 : [GHC.Types.Char] | lq_tmp$x##974 ~~ lq_anf$##1677728786##d1RU
                                    &amp;&amp; len lq_tmp$x##974 == strLen lq_anf$##1677728786##d1RU}</span><span class='hs-str'>"[SPAN]"</span></a>
<span class=hs-linenum> 92: </span>
<span class=hs-linenum> 93: </span><span class='hs-definition'>spanAdvancement</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Advancement</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>,</span> <span class='hs-conid'>ByteString</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 94: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##3036:(GHC.Types.Int, GHC.Types.Int) -&gt; lq_tmp$x##3037:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString)</span><span class='hs-definition'>spanAdvancement</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>bs</span></a>
<span class=hs-linenum> 95: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3077 : GHC.Types.Bool | Prop lq_tmp$x##3077 &lt;=&gt; l##a1ql == lq_anf$##1677728851##d1SX}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3082:{lq_tmp$x##3087 : GHC.Types.Int^"lq_tmp$x##3086" | $k_##3085[VV##3084:=lq_tmp$x##3087][lq_tmp$x##3081:=GHC.Classes.$fEqInt##rYw]} -&gt; lq_tmp$x##3083:{lq_tmp$x##3087 : GHC.Types.Int^"lq_tmp$x##3086" | $k_##3085[VV##3084:=lq_tmp$x##3087][lq_tmp$x##3081:=GHC.Classes.$fEqInt##rYw]} -&gt; {lq_tmp$x##3077 : GHC.Types.Bool | Prop lq_tmp$x##3077 &lt;=&gt; lq_tmp$x##3082 == lq_tmp$x##3083}</span><span class='hs-varop'>==</span></a> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3257 : lq_tmp$x##3258:GHC.Types.Int -&gt; lq_tmp$x##3259:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString) | lq_tmp$x##3257 == Data.ByteString.UTF8.splitAt##r3l}</span><span class='hs-varid'>splitAt</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum> 96: </span>  <span class='hs-comment'>-- | l == 0 = splitAt' (l, c - 1) bs</span>
<span class=hs-linenum> 97: </span>  <span class='hs-comment'>-- | l &gt; 0  = splitAt ((lineOffset l bs) + c - 1) bs</span>
<span class=hs-linenum> 98: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3124 : GHC.Types.Bool | Prop lq_tmp$x##3124 &lt;=&gt; l##a1ql &gt; lq_anf$##1677728854##d1T0}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3129:{lq_tmp$x##3134 : GHC.Types.Int^"lq_tmp$x##3133" | $k_##3132[VV##3131:=lq_tmp$x##3134][lq_tmp$x##3128:=GHC.Classes.$fOrdInt##rXb]} -&gt; lq_tmp$x##3130:{lq_tmp$x##3134 : GHC.Types.Int^"lq_tmp$x##3133" | $k_##3132[VV##3131:=lq_tmp$x##3134][lq_tmp$x##3128:=GHC.Classes.$fOrdInt##rXb]} -&gt; {lq_tmp$x##3124 : GHC.Types.Bool | Prop lq_tmp$x##3124 &lt;=&gt; lq_tmp$x##3129 &gt; lq_tmp$x##3130}</span><span class='hs-varop'>&gt;</span></a> <span class='hs-num'>0</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3230 : lq_tmp$x##3232:{lq_tmp$x##3222 : (GHC.Types.Int, GHC.Types.Int) | fst lq_tmp$x##3222 &gt; 0} -&gt; lq_tmp$x##3233:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString) | lq_tmp$x##3230 == Main.splitAt'##rRN}</span><span class='hs-varid'>splitAt'</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3189 : GHC.Types.Int^"lq_tmp$x##3188" | lq_tmp$x##3189 == c##a1qm - lq_anf$##1677728857##d1T3}</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3186:GHC.Types.Int -&gt; lq_tmp$x##3187:GHC.Types.Int -&gt; {lq_tmp$x##3189 : GHC.Types.Int^"lq_tmp$x##3188" | lq_tmp$x##3189 == lq_tmp$x##3186 - lq_tmp$x##3187}</span><span class='hs-comment'>-</span></a> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum> 99: </span><span class='hs-definition'>spanAdvancement</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
<span class=hs-linenum>100: </span>
<span class=hs-linenum>101: </span>
<span class=hs-linenum>102: </span><span class='hs-comment'>-- LiquidHaskell: l &gt; 0</span>
<span class=hs-linenum>103: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>splitAt'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{v:</span><span class='hs-keyword'>_</span> <span class='hs-keyword'>| fst v &gt; 0}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>,</span><span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>104: </span>
<span class=hs-linenum>105: </span><span class='hs-definition'>splitAt'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Advancement</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>,</span><span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>)</span>
<span class=hs-linenum>106: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2301:{v##1 : (GHC.Types.Int, GHC.Types.Int) | fst v##1 &gt; 0} -&gt; lq_tmp$x##2302:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString)</span><span class='hs-definition'>splitAt'</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>ls</span><span class='hs-layout'>,</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>bs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3000:{lq_tmp$x##2981 : GHC.Types.Int^"lq_tmp$x##2340" | $k_##2339[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][VV##2338:=lq_tmp$x##2981][lq_tmp$x##2998:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2999:=GHC.Num.$fNumInt##r1po]} -&gt; lq_tmp$x##3001:{lq_tmp$x##2985 : ({lq_tmp$x##3006 : GHC.Types.Int^"lq_tmp$x##3005" "lq_tmp$x##2344" | $k_##2343[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][VV##2352:=lq_tmp$x##2985][lq_tmp$x##2998:=GHC.Classes.$fEqInt##rYw][VV##2342:=lq_tmp$x##3006][lq_tmp$x##2337:=lq_tmp$x##3000][lq_tmp$x##2999:=GHC.Num.$fNumInt##r1po]}, {lq_tmp$x##2982 : GHC.Types.Int^"lq_tmp$x##2347" | $k_##2346[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][VV##2352:=lq_tmp$x##2985][VV##2345:=lq_tmp$x##2982][lq_tmp$x##2998:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2337:=lq_tmp$x##3000][lq_tmp$x##2999:=GHC.Num.$fNumInt##r1po]})^"lq_tmp$x##2354" | $k_##2353[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][VV##2352:=lq_tmp$x##2985][lq_tmp$x##2998:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2337:=lq_tmp$x##3000][lq_tmp$x##2999:=GHC.Num.$fNumInt##r1po]} -&gt; lq_tmp$x##3002:{lq_tmp$x##2986 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2358" | $k_##2357[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][VV##2356:=lq_tmp$x##2986][lq_tmp$x##2341:=lq_tmp$x##3001][lq_tmp$x##2998:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2337:=lq_tmp$x##3000][lq_tmp$x##2999:=GHC.Num.$fNumInt##r1po]} -&gt; {lq_tmp$x##2991 : ({lq_tmp$x##2987 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2361" | $k_##2360[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][VV##2369:=lq_tmp$x##2991][VV##2359:=lq_tmp$x##2987][lq_tmp$x##2355:=lq_tmp$x##3002][lq_tmp$x##2341:=lq_tmp$x##3001][lq_tmp$x##2998:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2337:=lq_tmp$x##3000][lq_tmp$x##2999:=GHC.Num.$fNumInt##r1po]}, {lq_tmp$x##2988 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2364" | $k_##2363[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][VV##2369:=lq_tmp$x##2991][lq_tmp$x##2355:=lq_tmp$x##3002][lq_tmp$x##2341:=lq_tmp$x##3001][lq_tmp$x##2998:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2337:=lq_tmp$x##3000][VV##2362:=lq_tmp$x##2988][lq_tmp$x##2999:=GHC.Num.$fNumInt##r1po]})^"lq_tmp$x##2371" | $k_##2370[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][VV##2369:=lq_tmp$x##2991][lq_tmp$x##2355:=lq_tmp$x##3002][lq_tmp$x##2341:=lq_tmp$x##3001][lq_tmp$x##2998:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2337:=lq_tmp$x##3000][lq_tmp$x##2999:=GHC.Num.$fNumInt##r1po]}</span><span class='hs-varid'>loop</span></a> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>ls</span><span class='hs-layout'>,</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum>107: </span>  <span class='hs-keyword'>where</span> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq t, GHC.Num.Num t) =&gt;
lq_tmp$x##2337:{VV##2338 : GHC.Types.Int^"lq_tmp$x##2340" | $k_##2339} -&gt; lq_tmp$x##2341:{VV##2352 : ({VV##2342 : t^"lq_tmp$x##2344" | $k_##2343}, {VV##2345 : GHC.Types.Int^"lq_tmp$x##2347" | $k_##2346})^"lq_tmp$x##2354" | $k_##2353} -&gt; lq_tmp$x##2355:{VV##2356 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2358" | $k_##2357} -&gt; {VV##2369 : ({VV##2359 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2361" | $k_##2360}, {VV##2362 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2364" | $k_##2363})^"lq_tmp$x##2371" | $k_##2370}</span><span class='hs-varid'>loop</span></a> <a class=annot href="#"><span class=annottext>{VV##2393 : GHC.Types.Int^"lq_tmp$x##2395" | $k_##2394}</span><span class='hs-varid'>a</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2522 : GHC.Types.Bool | Prop lq_tmp$x##2522 &lt;=&gt; lq_anf$##1677728825##d1Sx == lq_anf$##1677728829##d1SB}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2527:{lq_tmp$x##2545 : ({VV##2529 : t^"lq_tmp$x##2531" | $k_##2530[lq_tmp$x##2526:=fix$36$$36$dEq_a1Em][VV##2539:=lq_tmp$x##2545]}, {lq_tmp$x##2542 : GHC.Types.Int^"lq_tmp$x##2534" | $k_##2533[lq_tmp$x##2526:=fix$36$$36$dEq_a1Em][VV##2539:=lq_tmp$x##2545][VV##2532:=lq_tmp$x##2542]})^"lq_tmp$x##2541" | $k_##2540[lq_tmp$x##2526:=fix$36$$36$dEq_a1Em][VV##2539:=lq_tmp$x##2545]} -&gt; lq_tmp$x##2528:{lq_tmp$x##2545 : ({VV##2529 : t^"lq_tmp$x##2531" | $k_##2530[lq_tmp$x##2526:=fix$36$$36$dEq_a1Em][VV##2539:=lq_tmp$x##2545]}, {lq_tmp$x##2542 : GHC.Types.Int^"lq_tmp$x##2534" | $k_##2533[lq_tmp$x##2526:=fix$36$$36$dEq_a1Em][VV##2539:=lq_tmp$x##2545][VV##2532:=lq_tmp$x##2542]})^"lq_tmp$x##2541" | $k_##2540[lq_tmp$x##2526:=fix$36$$36$dEq_a1Em][VV##2539:=lq_tmp$x##2545]} -&gt; {lq_tmp$x##2522 : GHC.Types.Bool | Prop lq_tmp$x##2522 &lt;=&gt; lq_tmp$x##2527 == lq_tmp$x##2528}</span><span class='hs-varop'>==</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : t^"lq_tmp$x##2490" | VV == lq_anf$##1677728826##d1Sy}</span><span class='hs-num'>0</span></a><span class='hs-layout'>,</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2920 : lq_tmp$x##2921:GHC.Types.Int -&gt; lq_tmp$x##2922:Data.ByteString.Internal.ByteString -&gt; ({lq_tmp$x##2914 : Data.ByteString.Internal.ByteString | (lq_tmp$x##2921 &lt;= 0 &lt;=&gt; bslen lq_tmp$x##2914 == 0)
                                                                                                                                                                 &amp;&amp; (0 &lt;= lq_tmp$x##2921
                                                                                                                                                                     &amp;&amp; lq_tmp$x##2921 &lt;= bslen lq_tmp$x##2922 &lt;=&gt; bslen lq_tmp$x##2914 == lq_tmp$x##2921)
                                                                                                                                                                 &amp;&amp; (bslen lq_tmp$x##2922 &lt;= lq_tmp$x##2921 &lt;=&gt; bslen lq_tmp$x##2914 == bslen lq_tmp$x##2922)}, {lq_tmp$x##2915 : Data.ByteString.Internal.ByteString | (lq_tmp$x##2921 &lt;= 0 &lt;=&gt; bslen lq_tmp$x##2915 == bslen lq_tmp$x##2922)
                                                                                                                                                                                                                                                                                                                        &amp;&amp; (0 &lt;= lq_tmp$x##2921
                                                                                                                                                                                                                                                                                                                            &amp;&amp; lq_tmp$x##2921 &lt;= bslen lq_tmp$x##2922 &lt;=&gt; bslen lq_tmp$x##2915 == bslen lq_tmp$x##2922 - lq_tmp$x##2921)
                                                                                                                                                                                                                                                                                                                        &amp;&amp; (bslen lq_tmp$x##2922 &lt;= lq_tmp$x##2921 &lt;=&gt; bslen lq_tmp$x##2915 == 0)}) | lq_tmp$x##2920 == Data.ByteString.splitAt##r6I}</span><span class='hs-conid'>B</span></a><span class='hs-varop'>.</span><span class='hs-varid'>splitAt</span> <span class='hs-varid'>a</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum>108: </span>        <span class='hs-varid'>loop</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>bs1</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2594 : lq_tmp$x##2595:Data.ByteString.Internal.ByteString -&gt; (GHC.Base.Maybe (GHC.Types.Char, GHC.Types.Int)) | lq_tmp$x##2594 == Data.ByteString.UTF8.decode##r3v}</span><span class='hs-varid'>decode</span></a> <span class='hs-varid'>bs1</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum>109: </span>                         <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>ch</span><span class='hs-layout'>,</span><span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ch</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum>110: </span>                                          <span class='hs-chr'>'\n'</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2426:{VV##2393 : GHC.Types.Int^"lq_tmp$x##2395" | $k_##2394} -&gt; lq_tmp$x##2427:{VV##2406 : ({VV##2396 : t^"lq_tmp$x##2398" | $k_##2397[a##a1qt:=lq_tmp$x##2426]}, {VV##2399 : GHC.Types.Int^"lq_tmp$x##2401" | $k_##2400[a##a1qt:=lq_tmp$x##2426]})^"lq_tmp$x##2408" | $k_##2407[a##a1qt:=lq_tmp$x##2426]} -&gt; lq_tmp$x##2428:{VV##2409 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2411" | $k_##2410[ds_d1Rl:=lq_tmp$x##2427][a##a1qt:=lq_tmp$x##2426]} -&gt; {VV##2422 : ({VV##2412 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2414" | $k_##2413[ds_d1Rm:=lq_tmp$x##2428][ds_d1Rl:=lq_tmp$x##2427][a##a1qt:=lq_tmp$x##2426]}, {VV##2415 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2417" | $k_##2416[ds_d1Rm:=lq_tmp$x##2428][ds_d1Rl:=lq_tmp$x##2427][a##a1qt:=lq_tmp$x##2426]})^"lq_tmp$x##2424" | $k_##2423[ds_d1Rm:=lq_tmp$x##2428][ds_d1Rl:=lq_tmp$x##2427][a##a1qt:=lq_tmp$x##2426]}</span><span class='hs-varid'>loop</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2820 : GHC.Types.Int^"lq_tmp$x##2819" | lq_tmp$x##2820 == a##a1qt + y##a1qB}</span><span class='hs-varid'>a</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##2817:GHC.Types.Int -&gt; lq_tmp$x##2818:GHC.Types.Int -&gt; {lq_tmp$x##2820 : GHC.Types.Int^"lq_tmp$x##2819" | lq_tmp$x##2820 == lq_tmp$x##2817 + lq_tmp$x##2818}</span><span class='hs-varop'>+</span></a><span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : t^"lq_tmp$x##2845" | VV == l##a1qu - lq_anf$##1677728844##d1SQ}</span><span class='hs-varid'>l</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##2843:t -&gt; lq_tmp$x##2844:t -&gt; {VV : t^"lq_tmp$x##2845" | VV == lq_tmp$x##2843 - lq_tmp$x##2844}</span><span class='hs-comment'>-</span></a><a class=annot href="#"><span class=annottext>{VV : t^"lq_tmp$x##2834" | VV == lq_anf$##1677728843##d1SP}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2873 : lq_tmp$x##2874:GHC.Types.Int -&gt; lq_tmp$x##2875:Data.ByteString.Internal.ByteString -&gt; {lq_tmp$x##2871 : Data.ByteString.Internal.ByteString | (lq_tmp$x##2874 &lt;= 0 &lt;=&gt; bslen lq_tmp$x##2871 == bslen lq_tmp$x##2875)
                                                                                                                                                                &amp;&amp; (0 &lt;= lq_tmp$x##2874
                                                                                                                                                                    &amp;&amp; lq_tmp$x##2874 &lt;= bslen lq_tmp$x##2875 &lt;=&gt; bslen lq_tmp$x##2871 == bslen lq_tmp$x##2875 - lq_tmp$x##2874)
                                                                                                                                                                &amp;&amp; (bslen lq_tmp$x##2875 &lt;= lq_tmp$x##2874 &lt;=&gt; bslen lq_tmp$x##2871 == 0)} | lq_tmp$x##2873 == Data.ByteString.drop##r7R}</span><span class='hs-conid'>B</span></a><span class='hs-varop'>.</span><span class='hs-varid'>drop</span> <span class='hs-varid'>y</span> <span class='hs-varid'>bs1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>111: </span>                                          <span class='hs-keyword'>_</span>    <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2426:{VV##2393 : GHC.Types.Int^"lq_tmp$x##2395" | $k_##2394} -&gt; lq_tmp$x##2427:{VV##2406 : ({VV##2396 : t^"lq_tmp$x##2398" | $k_##2397[a##a1qt:=lq_tmp$x##2426]}, {VV##2399 : GHC.Types.Int^"lq_tmp$x##2401" | $k_##2400[a##a1qt:=lq_tmp$x##2426]})^"lq_tmp$x##2408" | $k_##2407[a##a1qt:=lq_tmp$x##2426]} -&gt; lq_tmp$x##2428:{VV##2409 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2411" | $k_##2410[ds_d1Rl:=lq_tmp$x##2427][a##a1qt:=lq_tmp$x##2426]} -&gt; {VV##2422 : ({VV##2412 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2414" | $k_##2413[ds_d1Rm:=lq_tmp$x##2428][ds_d1Rl:=lq_tmp$x##2427][a##a1qt:=lq_tmp$x##2426]}, {VV##2415 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2417" | $k_##2416[ds_d1Rm:=lq_tmp$x##2428][ds_d1Rl:=lq_tmp$x##2427][a##a1qt:=lq_tmp$x##2426]})^"lq_tmp$x##2424" | $k_##2423[ds_d1Rm:=lq_tmp$x##2428][ds_d1Rl:=lq_tmp$x##2427][a##a1qt:=lq_tmp$x##2426]}</span><span class='hs-varid'>loop</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2725 : GHC.Types.Int^"lq_tmp$x##2724" | lq_tmp$x##2725 == a##a1qt + y##a1qB}</span><span class='hs-varid'>a</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##2722:GHC.Types.Int -&gt; lq_tmp$x##2723:GHC.Types.Int -&gt; {lq_tmp$x##2725 : GHC.Types.Int^"lq_tmp$x##2724" | lq_tmp$x##2725 == lq_tmp$x##2722 + lq_tmp$x##2723}</span><span class='hs-varop'>+</span></a><span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2745 : GHC.Types.Int^"lq_tmp$x##2744" | lq_tmp$x##2745 == c##a1qv - lq_anf$##1677728838##d1SK}</span><span class='hs-varid'>c</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##2742:GHC.Types.Int -&gt; lq_tmp$x##2743:GHC.Types.Int -&gt; {lq_tmp$x##2745 : GHC.Types.Int^"lq_tmp$x##2744" | lq_tmp$x##2745 == lq_tmp$x##2742 - lq_tmp$x##2743}</span><span class='hs-comment'>-</span></a><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2776 : lq_tmp$x##2777:GHC.Types.Int -&gt; lq_tmp$x##2778:Data.ByteString.Internal.ByteString -&gt; {lq_tmp$x##2774 : Data.ByteString.Internal.ByteString | (lq_tmp$x##2777 &lt;= 0 &lt;=&gt; bslen lq_tmp$x##2774 == bslen lq_tmp$x##2778)
                                                                                                                                                                &amp;&amp; (0 &lt;= lq_tmp$x##2777
                                                                                                                                                                    &amp;&amp; lq_tmp$x##2777 &lt;= bslen lq_tmp$x##2778 &lt;=&gt; bslen lq_tmp$x##2774 == bslen lq_tmp$x##2778 - lq_tmp$x##2777)
                                                                                                                                                                &amp;&amp; (bslen lq_tmp$x##2778 &lt;= lq_tmp$x##2777 &lt;=&gt; bslen lq_tmp$x##2774 == 0)} | lq_tmp$x##2776 == Data.ByteString.drop##r7R}</span><span class='hs-conid'>B</span></a><span class='hs-varop'>.</span><span class='hs-varid'>drop</span> <span class='hs-varid'>y</span> <span class='hs-varid'>bs1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>112: </span>                         <span class='hs-conid'>Nothing</span>    <span class='hs-keyglyph'>-&gt;</span>  <span class='hs-layout'>(</span><span class='hs-varid'>bs</span><span class='hs-layout'>,</span> <span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-varid'>empty</span><span class='hs-layout'>)</span>
<span class=hs-linenum>113: </span>
<span class=hs-linenum>114: </span>
<span class=hs-linenum>115: </span><span class='hs-comment'>-- lineOffset :: Int -&gt; ByteString -&gt; Int</span>
<span class=hs-linenum>116: </span><span class='hs-comment'>-- lineOffset l bs = snd $ foldlUntil f endCond (l, 0) bs</span>
<span class=hs-linenum>117: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>118: </span><span class='hs-comment'>-- endCond :: (Int, Int) -&gt; Bool</span>
<span class=hs-linenum>119: </span><span class='hs-comment'>-- endCond (line, _) = line &lt; 1</span>
<span class=hs-linenum>120: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>121: </span><span class='hs-comment'>-- f :: (Int, Int) -&gt; Char -&gt; (Int, Int)</span>
<span class=hs-linenum>122: </span><span class='hs-comment'>-- f (l, offset) ch</span>
<span class=hs-linenum>123: </span><span class='hs-comment'>--   | l == 0     = (0, offset)</span>
<span class=hs-linenum>124: </span><span class='hs-comment'>--   | ch == '\n' = (l - 1, offset + 1)</span>
<span class=hs-linenum>125: </span><span class='hs-comment'>--   | otherwise  = (l, offset + 1)</span>
<span class=hs-linenum>126: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>127: </span><span class='hs-comment'>-- -- foldl with early opt-out</span>
<span class=hs-linenum>128: </span><span class='hs-comment'>-- foldlUntil :: (a -&gt; Char -&gt; a) -&gt; (a -&gt; Bool) -&gt; a -&gt; B.ByteString -&gt; a</span>
<span class=hs-linenum>129: </span><span class='hs-comment'>-- foldlUntil add optOut acc cs  = case uncons cs of</span>
<span class=hs-linenum>130: </span><span class='hs-comment'>--                       Just (a,as) -&gt; let v = add acc a</span>
<span class=hs-linenum>131: </span><span class='hs-comment'>--                                      in seq v $ if optOut v</span>
<span class=hs-linenum>132: </span><span class='hs-comment'>--                                                 then acc</span>
<span class=hs-linenum>133: </span><span class='hs-comment'>--                                                 else foldl add v as</span>
<span class=hs-linenum>134: </span><span class='hs-comment'>--                       Nothing     -&gt; acc</span>
<span class=hs-linenum>135: </span>
<span class=hs-linenum>136: </span>
<span class=hs-linenum>137: </span>
<span class=hs-linenum>138: </span><span class='hs-comment'>-- spanLines :: Advancement -&gt; ByteString -&gt; (ByteString, ByteString)</span>
<span class=hs-linenum>139: </span><span class='hs-comment'>-- spanLines (l, c) input =</span>
<span class=hs-linenum>140: </span><span class='hs-comment'>--   if l == 0 then</span>
<span class=hs-linenum>141: </span><span class='hs-comment'>--     splitAt c input</span>
<span class=hs-linenum>142: </span><span class='hs-comment'>--   else</span>
<span class=hs-linenum>143: </span><span class='hs-comment'>--     let (output, outputTail) = spans (mempty, input)</span>
<span class=hs-linenum>144: </span><span class='hs-comment'>--         (lastOutput, tailOutput) = splitAt (c - 1) outputTail</span>
<span class=hs-linenum>145: </span><span class='hs-comment'>--     in (output &lt;&gt; lastOutput, tailOutput)</span>
<span class=hs-linenum>146: </span><span class='hs-comment'>--     where</span>
<span class=hs-linenum>147: </span><span class='hs-comment'>--       spans = foldr (.) id (replicate l breakLines)</span>
<span class=hs-linenum>148: </span><span class='hs-comment'>--       breakLines (acc, bs) =</span>
<span class=hs-linenum>149: </span><span class='hs-comment'>--         let (linePart, bsTail) = break (== '\n') bs</span>
<span class=hs-linenum>150: </span><span class='hs-comment'>--             (lp, lt) = trace ("break " ++ show (linePart, bsTail)) (linePart, bsTail)</span>
<span class=hs-linenum>151: </span><span class='hs-comment'>--         in (acc &lt;&gt; lp &lt;&gt; take 1 lt, drop 1 lt)</span>
<span class=hs-linenum>152: </span>
</pre>
</body>
</html>