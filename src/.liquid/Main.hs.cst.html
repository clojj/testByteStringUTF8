<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/Users/jwin/stack-projects/testByteStringUTF8/src/Main.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><span class='hs-comment'>{-# LANGUAGE NoMonomorphismRestriction #-}</span>
<span class=hs-linenum>  2: </span>
<span class=hs-linenum>  3: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--notermination"</span>           <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  4: </span>
<span class=hs-linenum>  5: </span><span class='hs-comment'>{-# LANGUAGE UnicodeSyntax #-}</span>
<span class=hs-linenum>  6: </span><span class='hs-comment'>{-# LANGUAGE OverloadedStrings #-}</span>
<span class=hs-linenum>  7: </span>
<span class=hs-linenum>  8: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>splitAt</span><span class='hs-layout'>,</span> <span class='hs-varid'>length</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldl</span><span class='hs-layout'>,</span> <span class='hs-varid'>break</span><span class='hs-layout'>,</span> <span class='hs-varid'>drop</span><span class='hs-layout'>,</span> <span class='hs-varid'>take</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  9: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-varop'>.</span><span class='hs-conid'>UTF8</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>foldr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>B</span>
<span class=hs-linenum> 11: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Monoid</span>
<span class=hs-linenum> 12: </span>
<span class=hs-linenum> 13: </span><span class='hs-comment'>-- import Debug.Trace</span>
<span class=hs-linenum> 14: </span>
<span class=hs-linenum> 15: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Pos</span> <span class='hs-conid'>Int</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Classes.Eq Main.Pos)</span><span class='hs-conid'>Eq</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Show.Show Main.Pos)</span><span class='hs-conid'>Show</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 16: </span>
<span class=hs-linenum> 17: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Token</span>        <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conid'>Pos</span><span class='hs-layout'>,</span> <span class='hs-conid'>Pos</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>String</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 18: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Acc</span>          <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Pos</span><span class='hs-layout'>,</span> <span class='hs-conid'>ByteString</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 19: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Advancement</span>  <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 20: </span>
<span class=hs-linenum> 21: </span><span class='hs-comment'>-- TODO type Line = Int</span>
<span class=hs-linenum> 22: </span><span class='hs-comment'>-- TODO type Column = Int</span>
<span class=hs-linenum> 23: </span><span class='hs-comment'>-- TODO type Offset = Int</span>
<span class=hs-linenum> 24: </span>
<span class=hs-linenum> 25: </span><span class='hs-definition'>main</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 26: </span><a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##7205 : ()^"lq_tmp$x##7204" "lq_tmp$x##15" | $k_##7203[VV##7202:=lq_tmp$x##7205][lq_tmp$x##7201:=Main.main##rRH]})</span><span class='hs-definition'>main</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 27: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6724 : Data.ByteString.Internal.ByteString^"lq_tmp$x##6723" | $k_##6722[lq_tmp$x##6706:=lq_anf$##1677729024##d1VK][VV##6721:=lq_tmp$x##6724][lq_tmp$x##6705:=Data.ByteString.UTF8.fromString##r3r]}</span><span class='hs-varid'>content</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6730 : lq_tmp$x##6732:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##6730 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6678 : lq_tmp$x##6682:[[GHC.Types.Char]] -&gt; [GHC.Types.Char] | lq_tmp$x##6678 == Data.OldList.unlines##r2I}</span><span class='hs-varid'>unlines</span></a>
<span class=hs-linenum> 28: </span>                <span class='hs-keyglyph'>[</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##6232 : [GHC.Types.Char] | lq_tmp$x##6232 ~~ lq_anf$##1677729005##d1Vr
                                     &amp;&amp; len lq_tmp$x##6232 == strLen lq_anf$##1677729005##d1Vr}</span><span class='hs-str'>" aaa Zeile1 end1"</span></a><span class='hs-layout'>,</span>
<span class=hs-linenum> 29: </span>                 <a class=annot href="#"><span class=annottext>{lq_tmp$x##6244 : [GHC.Types.Char] | lq_tmp$x##6244 ~~ lq_anf$##1677729007##d1Vt
                                     &amp;&amp; len lq_tmp$x##6244 == strLen lq_anf$##1677729007##d1Vt}</span><span class='hs-str'>"Zeile 2 Ze"</span></a><span class='hs-layout'>,</span>
<span class=hs-linenum> 30: </span>                 <a class=annot href="#"><span class=annottext>{lq_tmp$x##6256 : [GHC.Types.Char] | lq_tmp$x##6256 ~~ lq_anf$##1677729009##d1Vv
                                     &amp;&amp; len lq_tmp$x##6256 == strLen lq_anf$##1677729009##d1Vv}</span><span class='hs-str'>"ile3 33 333 end3"</span></a><span class='hs-layout'>,</span>
<span class=hs-linenum> 31: </span>                 <a class=annot href="#"><span class=annottext>{lq_tmp$x##6268 : [GHC.Types.Char] | lq_tmp$x##6268 ~~ lq_anf$##1677729011##d1Vx
                                     &amp;&amp; len lq_tmp$x##6268 == strLen lq_anf$##1677729011##d1Vx}</span><span class='hs-str'>"Zeile4 Gaaaaanz l"</span></a><span class='hs-layout'>,</span>
<span class=hs-linenum> 32: </span>                 <a class=annot href="#"><span class=annottext>{lq_tmp$x##6280 : [GHC.Types.Char] | lq_tmp$x##6280 ~~ lq_anf$##1677729013##d1Vz
                                     &amp;&amp; len lq_tmp$x##6280 == strLen lq_anf$##1677729013##d1Vz}</span><span class='hs-str'>"aaaanges"</span></a><span class='hs-layout'>,</span>
<span class=hs-linenum> 33: </span>                 <a class=annot href="#"><span class=annottext>{lq_tmp$x##6292 : [GHC.Types.Char] | lq_tmp$x##6292 ~~ lq_anf$##1677729015##d1VB
                                     &amp;&amp; len lq_tmp$x##6292 == strLen lq_anf$##1677729015##d1VB}</span><span class='hs-str'>" Token  ENDE"</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 34: </span>
<span class=hs-linenum> 35: </span>      <a class=annot href="#"><span class=annottext>(Data.String.IsString t) =&gt;
{VV##4754 : [{VV##4727 : ({VV##4717 : ({VV##4707 : Main.Pos^"lq_tmp$x##4709" | $k_##4708}, {VV##4710 : Main.Pos^"lq_tmp$x##4712" | $k_##4711})^"lq_tmp$x##4719" | $k_##4718}, {VV##4720 : t^"lq_tmp$x##4722" | $k_##4721})^"lq_tmp$x##4729" | $k_##4728}]^"lq_tmp$x##4756" | $k_##4755}</span><span class='hs-varid'>tokens</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span>
<span class=hs-linenum> 36: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4773 : lq_tmp$x##4774:GHC.Types.Int -&gt; lq_tmp$x##4775:GHC.Types.Int -&gt; {lq_tmp$x##4771 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##4771 == Main.Pos##rRG lq_tmp$x##4774 lq_tmp$x##4775} | lq_tmp$x##4773 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>2</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4795 : lq_tmp$x##4796:GHC.Types.Int -&gt; lq_tmp$x##4797:GHC.Types.Int -&gt; {lq_tmp$x##4793 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##4793 == Main.Pos##rRG lq_tmp$x##4796 lq_tmp$x##4797} | lq_tmp$x##4795 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>t</span><span class='hs-str'>"special"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 37: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4911 : lq_tmp$x##4912:GHC.Types.Int -&gt; lq_tmp$x##4913:GHC.Types.Int -&gt; {lq_tmp$x##4909 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##4909 == Main.Pos##rRG lq_tmp$x##4912 lq_tmp$x##4913} | lq_tmp$x##4911 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>2</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4933 : lq_tmp$x##4934:GHC.Types.Int -&gt; lq_tmp$x##4935:GHC.Types.Int -&gt; {lq_tmp$x##4931 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##4931 == Main.Pos##rRG lq_tmp$x##4934 lq_tmp$x##4935} | lq_tmp$x##4933 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>5</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>t</span><span class='hs-str'>"token_aaa"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 38: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5049 : lq_tmp$x##5050:GHC.Types.Int -&gt; lq_tmp$x##5051:GHC.Types.Int -&gt; {lq_tmp$x##5047 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##5047 == Main.Pos##rRG lq_tmp$x##5050 lq_tmp$x##5051} | lq_tmp$x##5049 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>6</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5071 : lq_tmp$x##5072:GHC.Types.Int -&gt; lq_tmp$x##5073:GHC.Types.Int -&gt; {lq_tmp$x##5069 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##5069 == Main.Pos##rRG lq_tmp$x##5072 lq_tmp$x##5073} | lq_tmp$x##5071 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>12</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>t</span><span class='hs-str'>"token_Zeile1"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 39: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5187 : lq_tmp$x##5188:GHC.Types.Int -&gt; lq_tmp$x##5189:GHC.Types.Int -&gt; {lq_tmp$x##5185 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##5185 == Main.Pos##rRG lq_tmp$x##5188 lq_tmp$x##5189} | lq_tmp$x##5187 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>2</span> <span class='hs-num'>9</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5209 : lq_tmp$x##5210:GHC.Types.Int -&gt; lq_tmp$x##5211:GHC.Types.Int -&gt; {lq_tmp$x##5207 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##5207 == Main.Pos##rRG lq_tmp$x##5210 lq_tmp$x##5211} | lq_tmp$x##5209 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>3</span> <span class='hs-num'>5</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>t</span><span class='hs-str'>"token_Zeile3"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 40: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5325 : lq_tmp$x##5326:GHC.Types.Int -&gt; lq_tmp$x##5327:GHC.Types.Int -&gt; {lq_tmp$x##5323 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##5323 == Main.Pos##rRG lq_tmp$x##5326 lq_tmp$x##5327} | lq_tmp$x##5325 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>4</span> <span class='hs-num'>8</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5347 : lq_tmp$x##5348:GHC.Types.Int -&gt; lq_tmp$x##5349:GHC.Types.Int -&gt; {lq_tmp$x##5345 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##5345 == Main.Pos##rRG lq_tmp$x##5348 lq_tmp$x##5349} | lq_tmp$x##5347 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>6</span> <span class='hs-num'>7</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>t</span><span class='hs-str'>"token_laaang"</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 41: </span>        <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5463 : lq_tmp$x##5464:GHC.Types.Int -&gt; lq_tmp$x##5465:GHC.Types.Int -&gt; {lq_tmp$x##5461 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##5461 == Main.Pos##rRG lq_tmp$x##5464 lq_tmp$x##5465} | lq_tmp$x##5463 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>6</span> <span class='hs-num'>9</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5485 : lq_tmp$x##5486:GHC.Types.Int -&gt; lq_tmp$x##5487:GHC.Types.Int -&gt; {lq_tmp$x##5483 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##5483 == Main.Pos##rRG lq_tmp$x##5486 lq_tmp$x##5487} | lq_tmp$x##5485 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>6</span> <span class='hs-num'>13</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>t</span><span class='hs-str'>"token_ENDE"</span></a><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 42: </span>
<span class=hs-linenum> 43: </span>      <a class=annot href="#"><span class=annottext>(Data.String.IsString a) =&gt;
{VV##4672 : a^"lq_tmp$x##4674" | $k_##4673}</span><span class='hs-varid'>expectedLines</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 44: </span>        <span class='hs-str'>"[SPAN]WS[:] [SPAN][SPAN]special[SPAN][SPAN]token_aaa[:]aaa[SPAN][SPAN]WS[:] [SPAN][SPAN]token_Zeile1[:]Zeile1[SPAN][SPAN]WS[:] end1\n\
         \Zeile 2 [SPAN][SPAN]token_Zeile3[:]Ze\n\
         \ile3[SPAN][SPAN]WS[:] 33 333 end3\n\
         \Zeile4 [SPAN][SPAN]token_laaang[:]Gaaaaanz l\n\
         \aaaanges\n\
         \ Token[SPAN][SPAN]WS[:]  [SPAN][SPAN]token_ENDE[:]ENDE[SPAN][SPAN]WS[:]\n\
         \[SPAN]"</span>
<span class=hs-linenum> 51: </span>
<span class=hs-linenum> 52: </span>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 53: </span>    <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>r</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3292:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3293:[((Main.Pos, Main.Pos), [GHC.Types.Char])] -&gt; lq_tmp$x##3294:(Main.Pos, Data.ByteString.Internal.ByteString) -&gt; (GHC.Types.IO Data.ByteString.Internal.ByteString)</span><span class='hs-varid'>loopOver</span></a> <span class='hs-varid'>content</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6756 : [{lq_tmp$x##6747 : ({lq_tmp$x##6745 : ({lq_tmp$x##6741 : Main.Pos^"lq_tmp$x##4709" | $k_##4708[fix$36$$36$dIsString_a1Kj:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS][VV##4754:=lq_tmp$x##6756][VV##4727:=lq_tmp$x##6747][VV##4707:=lq_tmp$x##6741][VV##4717:=lq_tmp$x##6745][lq_tmp$x##6758:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS]}, {lq_tmp$x##6742 : Main.Pos^"lq_tmp$x##4712" | $k_##4711[fix$36$$36$dIsString_a1Kj:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS][VV##4754:=lq_tmp$x##6756][VV##4727:=lq_tmp$x##6747][VV##4710:=lq_tmp$x##6742][VV##4717:=lq_tmp$x##6745][lq_tmp$x##6758:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS]})^"lq_tmp$x##4719" | $k_##4718[fix$36$$36$dIsString_a1Kj:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS][VV##4754:=lq_tmp$x##6756][VV##4727:=lq_tmp$x##6747][VV##4717:=lq_tmp$x##6745][lq_tmp$x##6758:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS]}, {lq_tmp$x##6770 : [GHC.Types.Char]^"lq_tmp$x##6766" "lq_tmp$x##4722" | $k_##4721[fix$36$$36$dIsString_a1Kj:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS][VV##4754:=lq_tmp$x##6756][VV##4727:=lq_tmp$x##6747][VV##4720:=lq_tmp$x##6770][lq_tmp$x##6758:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS]})^"lq_tmp$x##4729" | $k_##4728[fix$36$$36$dIsString_a1Kj:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS][VV##4754:=lq_tmp$x##6756][VV##4727:=lq_tmp$x##6747][lq_tmp$x##6758:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS]}]^"lq_tmp$x##4756" | $k_##4755[fix$36$$36$dIsString_a1Kj:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS][VV##4754:=lq_tmp$x##6756][lq_tmp$x##6758:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS]}</span><span class='hs-varid'>tokens</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##6794 : lq_tmp$x##6795:GHC.Types.Int -&gt; lq_tmp$x##6796:GHC.Types.Int -&gt; {lq_tmp$x##6792 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##6792 == Main.Pos##rRG lq_tmp$x##6795 lq_tmp$x##6796} | lq_tmp$x##6794 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-num'>1</span> <span class='hs-num'>1</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>mempty</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 54: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>resultString</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6957 : lq_tmp$x##6958:Data.ByteString.Internal.ByteString -&gt; [GHC.Types.Char] | lq_tmp$x##6957 == Data.ByteString.UTF8.toString##r3j}</span><span class='hs-varid'>toString</span></a> <span class='hs-varid'>r</span>
<span class=hs-linenum> 55: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##6968 : lq_tmp$x##6970:[GHC.Types.Char] -&gt; (GHC.Types.IO ()) | lq_tmp$x##6968 == System.IO.putStrLn##r1I}</span><span class='hs-varid'>putStrLn</span></a> <span class='hs-varid'>resultString</span>
<span class=hs-linenum> 56: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##7001 : lq_tmp$x##7003:[GHC.Types.Char] -&gt; (GHC.Types.IO ()) | lq_tmp$x##7001 == System.IO.putStrLn##r1I}</span><span class='hs-varid'>putStrLn</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6987 : [GHC.Types.Char]^"lq_tmp$x##6983" "lq_tmp$x##4674" | $k_##4673[fix$36$$36$dIsString_a1JI:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS][VV##4672:=lq_tmp$x##6987][lq_tmp$x##6980:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS]}</span><span class='hs-varid'>expectedLines</span></a>
<span class=hs-linenum> 57: </span>    <a class=annot href="#"><span class=annottext>lq_tmp$x##7017:[GHC.Types.Char] -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>print</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##7096:GHC.Types.Bool -&gt; [GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##7041 : [GHC.Types.Char]^"lq_tmp$x##7037" "lq_tmp$x##4674" | $k_##4673[fix$36$$36$dIsString_a1JI:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS][lq_tmp$x##7034:=Data.String.$36$fIsString$91$$93$$35$$35$r1HS][VV##4672:=lq_tmp$x##7041]}</span><span class='hs-varid'>expectedLines</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##7055:{lq_tmp$x##7070 : [{lq_tmp$x##7067 : GHC.Types.Char^"lq_tmp$x##7059" | $k_##7058[lq_tmp$x##7054:=fix$36$$36$dEq_a1Ll][VV##7064:=lq_tmp$x##7070][VV##7057:=lq_tmp$x##7067]}]^"lq_tmp$x##7066" | $k_##7065[lq_tmp$x##7054:=fix$36$$36$dEq_a1Ll][VV##7064:=lq_tmp$x##7070]} -&gt; lq_tmp$x##7056:{lq_tmp$x##7070 : [{lq_tmp$x##7067 : GHC.Types.Char^"lq_tmp$x##7059" | $k_##7058[lq_tmp$x##7054:=fix$36$$36$dEq_a1Ll][VV##7064:=lq_tmp$x##7070][VV##7057:=lq_tmp$x##7067]}]^"lq_tmp$x##7066" | $k_##7065[lq_tmp$x##7054:=fix$36$$36$dEq_a1Ll][VV##7064:=lq_tmp$x##7070]} -&gt; {lq_tmp$x##7050 : GHC.Types.Bool | Prop lq_tmp$x##7050 &lt;=&gt; lq_tmp$x##7055 == lq_tmp$x##7056}</span><span class='hs-varop'>==</span></a> <span class='hs-varid'>resultString</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 58: </span>
<span class=hs-linenum> 59: </span><span class='hs-definition'>loopOver</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Token</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Acc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 60: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##3292:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3293:[((Main.Pos, Main.Pos), [GHC.Types.Char])] -&gt; lq_tmp$x##3294:(Main.Pos, Data.ByteString.Internal.ByteString) -&gt; (GHC.Types.IO Data.ByteString.Internal.ByteString)</span><span class='hs-definition'>loopOver</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>bs</span></a> <a class=annot href="#"><span class=annottext>[((Main.Pos, Main.Pos), [GHC.Types.Char])]</span><span class='hs-varid'>tokens</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>currentPos</span><span class='hs-layout'>,</span> <span class='hs-varid'>result</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 61: </span>  <span class='hs-keyword'>case</span> <span class='hs-varid'>tokens</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 62: </span>
<span class=hs-linenum> 63: </span>    <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##75:a -&gt; (GHC.Types.IO a)</span><span class='hs-varid'>return</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>result</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3529:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3530:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sepPart</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3515:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3516:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3458 : lq_tmp$x##3460:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##3458 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3447 : [GHC.Types.Char] | lq_tmp$x##3447 ~~ lq_anf$##1677728891##d1TB
                                     &amp;&amp; len lq_tmp$x##3447 == strLen lq_anf$##1677728891##d1TB}</span><span class='hs-str'>"WS"</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3501:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3502:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sep</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3487:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3488:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>bs</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3473:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3474:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <span class='hs-varid'>sepPart</span>
<span class=hs-linenum> 64: </span>
<span class=hs-linenum> 65: </span>    <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>pos1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Pos</span> <span class='hs-varid'>l1</span> <span class='hs-varid'>c1</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>pos2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Pos</span> <span class='hs-varid'>l2</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>tname</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>tokenTail</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum> 66: </span>      <span class='hs-comment'>-- putStrLn ("currentPos " ++ show currentPos ++ " pos1 " ++ show pos1 ++ " advanceLinesAndColumns " ++ show (advanceLinesAndColumns currentPos pos1)) &gt;&gt;</span>
<span class=hs-linenum> 67: </span>
<span class=hs-linenum> 68: </span>      <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3745 : GHC.Types.Bool | Prop lq_tmp$x##3745 &lt;=&gt; currentPos##a1p1 == lq_anf$##1677728901##d1TL}</span><span class='hs-varid'>currentPos</span></a> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq Main.Pos)</span><span class='hs-varop'>==</span></a> <span class='hs-varid'>pos1</span> <span class='hs-keyword'>then</span>
<span class=hs-linenum> 69: </span>        <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4111 : GHC.Types.Bool | Prop lq_tmp$x##4111 &lt;=&gt; lq_anf$##1677728901##d1TL == lq_anf$##1677728902##d1TM}</span><span class='hs-varid'>pos1</span></a> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq Main.Pos)</span><span class='hs-varop'>==</span></a> <span class='hs-varid'>pos2</span> <span class='hs-keyword'>then</span>
<span class=hs-linenum> 70: </span>          <a class=annot href="#"><span class=annottext>lq_tmp$x##3292:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3293:[((Main.Pos, Main.Pos), [GHC.Types.Char])] -&gt; lq_tmp$x##3294:(Main.Pos, Data.ByteString.Internal.ByteString) -&gt; (GHC.Types.IO Data.ByteString.Internal.ByteString)</span><span class='hs-varid'>loopOver</span></a> <span class='hs-varid'>bs</span> <span class='hs-varid'>tokenTail</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4468 : lq_tmp$x##4469:GHC.Types.Int -&gt; lq_tmp$x##4470:GHC.Types.Int -&gt; {lq_tmp$x##4466 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##4466 == Main.Pos##rRG lq_tmp$x##4469 lq_tmp$x##4470} | lq_tmp$x##4468 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-varid'>l1</span> <span class='hs-varid'>c1</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>result</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4522:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4523:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sepPart</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4508:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4509:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4479 : lq_tmp$x##4481:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##4479 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <span class='hs-varid'>tname</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4494:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4495:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <span class='hs-varid'>sepPart</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 71: </span>        <span class='hs-keyword'>else</span>
<span class=hs-linenum> 72: </span>          <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, GHC.Types.Int)</span><span class='hs-varid'>advancement</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4142 : lq_tmp$x##4143:Main.Pos -&gt; lq_tmp$x##4144:Main.Pos -&gt; (GHC.Types.Int, GHC.Types.Int) | lq_tmp$x##4142 == Main.advanceLinesAndColumns##rRJ}</span><span class='hs-varid'>advanceLinesAndColumns</span></a> <span class='hs-varid'>pos1</span> <span class='hs-varid'>pos2</span>
<span class=hs-linenum> 73: </span>              <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##4175 : Data.ByteString.Internal.ByteString^"lq_tmp$x##4177" | $k_##4176}</span><span class='hs-varid'>token</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##4201 : Data.ByteString.Internal.ByteString^"lq_tmp$x##4203" | $k_##4202}</span><span class='hs-varid'>bsTail</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4161 : lq_tmp$x##4163:(GHC.Types.Int, GHC.Types.Int) -&gt; lq_tmp$x##4164:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString) | lq_tmp$x##4161 == Main.spanAdvancement##rRM}</span><span class='hs-varid'>spanAdvancement</span></a> <span class='hs-varid'>advancement</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum> 74: </span>              <span class='hs-comment'>-- (token, bsTail) = spanLines advancement bs</span>
<span class=hs-linenum> 75: </span>          <span class='hs-keyword'>in</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3292:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3293:[((Main.Pos, Main.Pos), [GHC.Types.Char])] -&gt; lq_tmp$x##3294:(Main.Pos, Data.ByteString.Internal.ByteString) -&gt; (GHC.Types.IO Data.ByteString.Internal.ByteString)</span><span class='hs-varid'>loopOver</span></a> <span class='hs-varid'>bsTail</span> <span class='hs-varid'>tokenTail</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4231 : lq_tmp$x##4232:GHC.Types.Int -&gt; lq_tmp$x##4233:GHC.Types.Int -&gt; {lq_tmp$x##4229 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##4229 == Main.Pos##rRG lq_tmp$x##4232 lq_tmp$x##4233} | lq_tmp$x##4231 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-varid'>l2</span> <span class='hs-varid'>c2</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>result</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4313:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4314:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sepPart</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4299:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4300:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4242 : lq_tmp$x##4244:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##4242 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <span class='hs-varid'>tname</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4285:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4286:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sep</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4271:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4272:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>token</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4257:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##4258:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <span class='hs-varid'>sepPart</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 76: </span>      <span class='hs-keyword'>else</span>
<span class=hs-linenum> 77: </span>        <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, GHC.Types.Int)</span><span class='hs-varid'>advancement</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3776 : lq_tmp$x##3777:Main.Pos -&gt; lq_tmp$x##3778:Main.Pos -&gt; (GHC.Types.Int, GHC.Types.Int) | lq_tmp$x##3776 == Main.advanceLinesAndColumns##rRJ}</span><span class='hs-varid'>advanceLinesAndColumns</span></a> <span class='hs-varid'>currentPos</span> <span class='hs-varid'>pos1</span>
<span class=hs-linenum> 78: </span>            <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##3809 : Data.ByteString.Internal.ByteString^"lq_tmp$x##3811" | $k_##3810}</span><span class='hs-varid'>ws</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##3835 : Data.ByteString.Internal.ByteString^"lq_tmp$x##3837" | $k_##3836}</span><span class='hs-varid'>bsTail</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3795 : lq_tmp$x##3797:(GHC.Types.Int, GHC.Types.Int) -&gt; lq_tmp$x##3798:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString) | lq_tmp$x##3795 == Main.spanAdvancement##rRM}</span><span class='hs-varid'>spanAdvancement</span></a> <span class='hs-varid'>advancement</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum> 79: </span>            <span class='hs-comment'>-- (ws, bsTail) = spanLines advancement bs</span>
<span class=hs-linenum> 80: </span>        <span class='hs-keyword'>in</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3292:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3293:[((Main.Pos, Main.Pos), [GHC.Types.Char])] -&gt; lq_tmp$x##3294:(Main.Pos, Data.ByteString.Internal.ByteString) -&gt; (GHC.Types.IO Data.ByteString.Internal.ByteString)</span><span class='hs-varid'>loopOver</span></a> <span class='hs-varid'>bsTail</span> <span class='hs-varid'>tokens</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3865 : lq_tmp$x##3866:GHC.Types.Int -&gt; lq_tmp$x##3867:GHC.Types.Int -&gt; {lq_tmp$x##3863 : Main.Pos^"lq_tmp$x##432" | lq_tmp$x##3863 == Main.Pos##rRG lq_tmp$x##3866 lq_tmp$x##3867} | lq_tmp$x##3865 == Main.Pos##rRG}</span><span class='hs-conid'>Pos</span></a> <span class='hs-varid'>l1</span> <span class='hs-varid'>c1</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>result</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3959:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3960:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sepPart</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3945:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3946:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3888 : lq_tmp$x##3890:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##3888 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3877 : [GHC.Types.Char] | lq_tmp$x##3877 ~~ lq_anf$##1677728906##d1TQ
                                     &amp;&amp; len lq_tmp$x##3877 == strLen lq_anf$##1677728906##d1TQ}</span><span class='hs-str'>"WS"</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3931:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3932:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>sep</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3917:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3918:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>ws</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3903:Data.ByteString.Internal.ByteString -&gt; lq_tmp$x##3904:Data.ByteString.Internal.ByteString -&gt; Data.ByteString.Internal.ByteString</span><span class='hs-varop'>&lt;&gt;</span></a> <span class='hs-varid'>sepPart</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 81: </span>
<span class=hs-linenum> 82: </span><span class='hs-definition'>advanceLinesAndColumns</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Advancement</span>
<span class=hs-linenum> 83: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2046:Main.Pos -&gt; lq_tmp$x##2047:Main.Pos -&gt; (GHC.Types.Int, GHC.Types.Int)</span><span class='hs-definition'>advanceLinesAndColumns</span></a> <a class=annot href="#"><span class=annottext>Main.Pos</span><span class='hs-varid'>p1</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Pos</span> <span class='hs-varid'>l1</span> <span class='hs-varid'>c1</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>Main.Pos</span><span class='hs-varid'>p2</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Pos</span> <span class='hs-varid'>l2</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 84: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2090 : GHC.Types.Bool | Prop lq_tmp$x##2090 &lt;=&gt; lq_anf$##1677728838##d1SK == lq_anf$##1677728839##d1SL}</span><span class='hs-varid'>p1</span></a> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq Main.Pos)</span><span class='hs-varop'>==</span></a> <span class='hs-varid'>p2</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 85: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2138 : GHC.Types.Int^"lq_tmp$x##2137" | lq_tmp$x##2138 == l2##a1pl - l1##a1pi}</span><span class='hs-varid'>l2</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##2135:GHC.Types.Int -&gt; lq_tmp$x##2136:GHC.Types.Int -&gt; {lq_tmp$x##2138 : GHC.Types.Int^"lq_tmp$x##2137" | lq_tmp$x##2138 == lq_tmp$x##2135 - lq_tmp$x##2136}</span><span class='hs-comment'>-</span></a> <span class='hs-varid'>l1</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2156:{lq_tmp$x##2161 : GHC.Types.Int^"lq_tmp$x##2160" | $k_##2159[lq_tmp$x##2155:=GHC.Classes.$fOrdInt##rXb][VV##2158:=lq_tmp$x##2161]} -&gt; lq_tmp$x##2157:{lq_tmp$x##2161 : GHC.Types.Int^"lq_tmp$x##2160" | $k_##2159[lq_tmp$x##2155:=GHC.Classes.$fOrdInt##rXb][VV##2158:=lq_tmp$x##2161]} -&gt; {lq_tmp$x##2151 : GHC.Types.Bool | Prop lq_tmp$x##2151 &lt;=&gt; lq_tmp$x##2156 &gt; lq_tmp$x##2157}</span><span class='hs-varop'>&gt;</span></a> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2247 : GHC.Types.Int^"lq_tmp$x##2246" | lq_tmp$x##2247 == l2##a1pl - l1##a1pi}</span><span class='hs-varid'>l2</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##2244:GHC.Types.Int -&gt; lq_tmp$x##2245:GHC.Types.Int -&gt; {lq_tmp$x##2247 : GHC.Types.Int^"lq_tmp$x##2246" | lq_tmp$x##2247 == lq_tmp$x##2244 - lq_tmp$x##2245}</span><span class='hs-comment'>-</span></a> <span class='hs-varid'>l1</span><span class='hs-layout'>,</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 86: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2205 : GHC.Types.Int^"lq_tmp$x##2204" | lq_tmp$x##2205 == c2##a1pm - c1##a1pj}</span><span class='hs-varid'>c2</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##2202:GHC.Types.Int -&gt; lq_tmp$x##2203:GHC.Types.Int -&gt; {lq_tmp$x##2205 : GHC.Types.Int^"lq_tmp$x##2204" | lq_tmp$x##2205 == lq_tmp$x##2202 - lq_tmp$x##2203}</span><span class='hs-comment'>-</span></a> <span class='hs-varid'>c1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 87: </span>
<span class=hs-linenum> 88: </span><span class='hs-definition'>sep</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 89: </span><a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-definition'>sep</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1029 : lq_tmp$x##1031:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##1029 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1018 : [GHC.Types.Char] | lq_tmp$x##1018 ~~ lq_anf$##1677728816##d1So
                                     &amp;&amp; len lq_tmp$x##1018 == strLen lq_anf$##1677728816##d1So}</span><span class='hs-str'>"[:]"</span></a>
<span class=hs-linenum> 90: </span>
<span class=hs-linenum> 91: </span><span class='hs-definition'>sepPart</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteString</span>
<span class=hs-linenum> 92: </span><a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-definition'>sepPart</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1002 : lq_tmp$x##1004:[GHC.Types.Char] -&gt; Data.ByteString.Internal.ByteString | lq_tmp$x##1002 == Data.ByteString.UTF8.fromString##r3r}</span><span class='hs-varid'>fromString</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##991 : [GHC.Types.Char] | lq_tmp$x##991 ~~ lq_anf$##1677728814##d1Sm
                                    &amp;&amp; len lq_tmp$x##991 == strLen lq_anf$##1677728814##d1Sm}</span><span class='hs-str'>"[SPAN]"</span></a>
<span class=hs-linenum> 93: </span>
<span class=hs-linenum> 94: </span><span class='hs-definition'>spanAdvancement</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Advancement</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>,</span> <span class='hs-conid'>ByteString</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 95: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##3053:(GHC.Types.Int, GHC.Types.Int) -&gt; lq_tmp$x##3054:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString)</span><span class='hs-definition'>spanAdvancement</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>bs</span></a>
<span class=hs-linenum> 96: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3094 : GHC.Types.Bool | Prop lq_tmp$x##3094 &lt;=&gt; l##a1ql == lq_anf$##1677728879##d1Tp}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3099:{lq_tmp$x##3104 : GHC.Types.Int^"lq_tmp$x##3103" | $k_##3102[VV##3101:=lq_tmp$x##3104][lq_tmp$x##3098:=GHC.Classes.$fEqInt##rYw]} -&gt; lq_tmp$x##3100:{lq_tmp$x##3104 : GHC.Types.Int^"lq_tmp$x##3103" | $k_##3102[VV##3101:=lq_tmp$x##3104][lq_tmp$x##3098:=GHC.Classes.$fEqInt##rYw]} -&gt; {lq_tmp$x##3094 : GHC.Types.Bool | Prop lq_tmp$x##3094 &lt;=&gt; lq_tmp$x##3099 == lq_tmp$x##3100}</span><span class='hs-varop'>==</span></a> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3274 : lq_tmp$x##3275:GHC.Types.Int -&gt; lq_tmp$x##3276:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString) | lq_tmp$x##3274 == Data.ByteString.UTF8.splitAt##r3l}</span><span class='hs-varid'>splitAt</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum> 97: </span>  <span class='hs-comment'>-- | l == 0 = splitAt' (l, c - 1) bs</span>
<span class=hs-linenum> 98: </span>  <span class='hs-comment'>-- | l &gt; 0  = splitAt ((lineOffset l bs) + c - 1) bs</span>
<span class=hs-linenum> 99: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3141 : GHC.Types.Bool | Prop lq_tmp$x##3141 &lt;=&gt; l##a1ql &gt; lq_anf$##1677728882##d1Ts}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3146:{lq_tmp$x##3151 : GHC.Types.Int^"lq_tmp$x##3150" | $k_##3149[VV##3148:=lq_tmp$x##3151][lq_tmp$x##3145:=GHC.Classes.$fOrdInt##rXb]} -&gt; lq_tmp$x##3147:{lq_tmp$x##3151 : GHC.Types.Int^"lq_tmp$x##3150" | $k_##3149[VV##3148:=lq_tmp$x##3151][lq_tmp$x##3145:=GHC.Classes.$fOrdInt##rXb]} -&gt; {lq_tmp$x##3141 : GHC.Types.Bool | Prop lq_tmp$x##3141 &lt;=&gt; lq_tmp$x##3146 &gt; lq_tmp$x##3147}</span><span class='hs-varop'>&gt;</span></a> <span class='hs-num'>0</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3247 : lq_tmp$x##3249:{lq_tmp$x##3239 : (GHC.Types.Int, GHC.Types.Int) | fst lq_tmp$x##3239 &gt; 0} -&gt; lq_tmp$x##3250:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString) | lq_tmp$x##3247 == Main.splitAt'##rRN}</span><span class='hs-varid'>splitAt'</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3206 : GHC.Types.Int^"lq_tmp$x##3205" | lq_tmp$x##3206 == c##a1qm - lq_anf$##1677728885##d1Tv}</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3203:GHC.Types.Int -&gt; lq_tmp$x##3204:GHC.Types.Int -&gt; {lq_tmp$x##3206 : GHC.Types.Int^"lq_tmp$x##3205" | lq_tmp$x##3206 == lq_tmp$x##3203 - lq_tmp$x##3204}</span><span class='hs-comment'>-</span></a> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum>100: </span><span class='hs-definition'>spanAdvancement</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
<span class=hs-linenum>101: </span>
<span class=hs-linenum>102: </span>
<span class=hs-linenum>103: </span><span class='hs-comment'>-- LiquidHaskell: l &gt; 0</span>
<span class=hs-linenum>104: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>splitAt'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{v:</span><span class='hs-keyword'>_</span> <span class='hs-keyword'>| fst v &gt; 0}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>,</span><span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>105: </span>
<span class=hs-linenum>106: </span><span class='hs-definition'>splitAt'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Advancement</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>,</span><span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>)</span>
<span class=hs-linenum>107: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2318:{v##1 : (GHC.Types.Int, GHC.Types.Int) | fst v##1 &gt; 0} -&gt; lq_tmp$x##2319:Data.ByteString.Internal.ByteString -&gt; (Data.ByteString.Internal.ByteString, Data.ByteString.Internal.ByteString)</span><span class='hs-definition'>splitAt'</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>ls</span><span class='hs-layout'>,</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>Data.ByteString.Internal.ByteString</span><span class='hs-varid'>bs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3017:{lq_tmp$x##2998 : GHC.Types.Int^"lq_tmp$x##2357" | $k_##2356[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##3016:=GHC.Num.$fNumInt##r1po][lq_tmp$x##3015:=GHC.Classes.$fEqInt##rYw][VV##2355:=lq_tmp$x##2998]} -&gt; lq_tmp$x##3018:{lq_tmp$x##3002 : ({lq_tmp$x##3023 : GHC.Types.Int^"lq_tmp$x##3022" "lq_tmp$x##2361" | $k_##2360[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##3016:=GHC.Num.$fNumInt##r1po][VV##2369:=lq_tmp$x##3002][VV##2359:=lq_tmp$x##3023][lq_tmp$x##3015:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2354:=lq_tmp$x##3017]}, {lq_tmp$x##2999 : GHC.Types.Int^"lq_tmp$x##2364" | $k_##2363[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##3016:=GHC.Num.$fNumInt##r1po][VV##2369:=lq_tmp$x##3002][lq_tmp$x##3015:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2354:=lq_tmp$x##3017][VV##2362:=lq_tmp$x##2999]})^"lq_tmp$x##2371" | $k_##2370[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##3016:=GHC.Num.$fNumInt##r1po][VV##2369:=lq_tmp$x##3002][lq_tmp$x##3015:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2354:=lq_tmp$x##3017]} -&gt; lq_tmp$x##3019:{lq_tmp$x##3003 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2375" | $k_##2374[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##3016:=GHC.Num.$fNumInt##r1po][lq_tmp$x##3015:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2354:=lq_tmp$x##3017][lq_tmp$x##2358:=lq_tmp$x##3018][VV##2373:=lq_tmp$x##3003]} -&gt; {lq_tmp$x##3008 : ({lq_tmp$x##3004 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2378" | $k_##2377[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##3016:=GHC.Num.$fNumInt##r1po][lq_tmp$x##2372:=lq_tmp$x##3019][lq_tmp$x##3015:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2354:=lq_tmp$x##3017][VV##2386:=lq_tmp$x##3008][lq_tmp$x##2358:=lq_tmp$x##3018][VV##2376:=lq_tmp$x##3004]}, {lq_tmp$x##3005 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2381" | $k_##2380[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##3016:=GHC.Num.$fNumInt##r1po][lq_tmp$x##2372:=lq_tmp$x##3019][lq_tmp$x##3015:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2354:=lq_tmp$x##3017][VV##2379:=lq_tmp$x##3005][VV##2386:=lq_tmp$x##3008][lq_tmp$x##2358:=lq_tmp$x##3018]})^"lq_tmp$x##2388" | $k_##2387[fix$36$$36$dNum_a1Gr:=GHC.Num.$fNumInt##r1po][fix$36$$36$dEq_a1Gq:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##3016:=GHC.Num.$fNumInt##r1po][lq_tmp$x##2372:=lq_tmp$x##3019][lq_tmp$x##3015:=GHC.Classes.$fEqInt##rYw][lq_tmp$x##2354:=lq_tmp$x##3017][VV##2386:=lq_tmp$x##3008][lq_tmp$x##2358:=lq_tmp$x##3018]}</span><span class='hs-varid'>loop</span></a> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>ls</span><span class='hs-layout'>,</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum>108: </span>  <span class='hs-keyword'>where</span> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq t, GHC.Num.Num t) =&gt;
lq_tmp$x##2354:{VV##2355 : GHC.Types.Int^"lq_tmp$x##2357" | $k_##2356} -&gt; lq_tmp$x##2358:{VV##2369 : ({VV##2359 : t^"lq_tmp$x##2361" | $k_##2360}, {VV##2362 : GHC.Types.Int^"lq_tmp$x##2364" | $k_##2363})^"lq_tmp$x##2371" | $k_##2370} -&gt; lq_tmp$x##2372:{VV##2373 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2375" | $k_##2374} -&gt; {VV##2386 : ({VV##2376 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2378" | $k_##2377}, {VV##2379 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2381" | $k_##2380})^"lq_tmp$x##2388" | $k_##2387}</span><span class='hs-varid'>loop</span></a> <a class=annot href="#"><span class=annottext>{VV##2410 : GHC.Types.Int^"lq_tmp$x##2412" | $k_##2411}</span><span class='hs-varid'>a</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2539 : GHC.Types.Bool | Prop lq_tmp$x##2539 &lt;=&gt; lq_anf$##1677728853##d1SZ == lq_anf$##1677728857##d1T3}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2544:{lq_tmp$x##2562 : ({VV##2546 : t^"lq_tmp$x##2548" | $k_##2547[VV##2556:=lq_tmp$x##2562][lq_tmp$x##2543:=fix$36$$36$dEq_a1Em]}, {lq_tmp$x##2559 : GHC.Types.Int^"lq_tmp$x##2551" | $k_##2550[VV##2556:=lq_tmp$x##2562][VV##2549:=lq_tmp$x##2559][lq_tmp$x##2543:=fix$36$$36$dEq_a1Em]})^"lq_tmp$x##2558" | $k_##2557[VV##2556:=lq_tmp$x##2562][lq_tmp$x##2543:=fix$36$$36$dEq_a1Em]} -&gt; lq_tmp$x##2545:{lq_tmp$x##2562 : ({VV##2546 : t^"lq_tmp$x##2548" | $k_##2547[VV##2556:=lq_tmp$x##2562][lq_tmp$x##2543:=fix$36$$36$dEq_a1Em]}, {lq_tmp$x##2559 : GHC.Types.Int^"lq_tmp$x##2551" | $k_##2550[VV##2556:=lq_tmp$x##2562][VV##2549:=lq_tmp$x##2559][lq_tmp$x##2543:=fix$36$$36$dEq_a1Em]})^"lq_tmp$x##2558" | $k_##2557[VV##2556:=lq_tmp$x##2562][lq_tmp$x##2543:=fix$36$$36$dEq_a1Em]} -&gt; {lq_tmp$x##2539 : GHC.Types.Bool | Prop lq_tmp$x##2539 &lt;=&gt; lq_tmp$x##2544 == lq_tmp$x##2545}</span><span class='hs-varop'>==</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : t^"lq_tmp$x##2507" | VV == lq_anf$##1677728854##d1T0}</span><span class='hs-num'>0</span></a><span class='hs-layout'>,</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2937 : lq_tmp$x##2938:GHC.Types.Int -&gt; lq_tmp$x##2939:Data.ByteString.Internal.ByteString -&gt; ({lq_tmp$x##2931 : Data.ByteString.Internal.ByteString | (lq_tmp$x##2938 &lt;= 0 &lt;=&gt; bslen lq_tmp$x##2931 == 0)
                                                                                                                                                                 &amp;&amp; (0 &lt;= lq_tmp$x##2938
                                                                                                                                                                     &amp;&amp; lq_tmp$x##2938 &lt;= bslen lq_tmp$x##2939 &lt;=&gt; bslen lq_tmp$x##2931 == lq_tmp$x##2938)
                                                                                                                                                                 &amp;&amp; (bslen lq_tmp$x##2939 &lt;= lq_tmp$x##2938 &lt;=&gt; bslen lq_tmp$x##2931 == bslen lq_tmp$x##2939)}, {lq_tmp$x##2932 : Data.ByteString.Internal.ByteString | (lq_tmp$x##2938 &lt;= 0 &lt;=&gt; bslen lq_tmp$x##2932 == bslen lq_tmp$x##2939)
                                                                                                                                                                                                                                                                                                                        &amp;&amp; (0 &lt;= lq_tmp$x##2938
                                                                                                                                                                                                                                                                                                                            &amp;&amp; lq_tmp$x##2938 &lt;= bslen lq_tmp$x##2939 &lt;=&gt; bslen lq_tmp$x##2932 == bslen lq_tmp$x##2939 - lq_tmp$x##2938)
                                                                                                                                                                                                                                                                                                                        &amp;&amp; (bslen lq_tmp$x##2939 &lt;= lq_tmp$x##2938 &lt;=&gt; bslen lq_tmp$x##2932 == 0)}) | lq_tmp$x##2937 == Data.ByteString.splitAt##r6I}</span><span class='hs-conid'>B</span></a><span class='hs-varop'>.</span><span class='hs-varid'>splitAt</span> <span class='hs-varid'>a</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum>109: </span>        <span class='hs-varid'>loop</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>bs1</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2611 : lq_tmp$x##2612:Data.ByteString.Internal.ByteString -&gt; (GHC.Base.Maybe (GHC.Types.Char, GHC.Types.Int)) | lq_tmp$x##2611 == Data.ByteString.UTF8.decode##r3v}</span><span class='hs-varid'>decode</span></a> <span class='hs-varid'>bs1</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum>110: </span>                         <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>ch</span><span class='hs-layout'>,</span><span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ch</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum>111: </span>                                          <span class='hs-chr'>'\n'</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2443:{VV##2410 : GHC.Types.Int^"lq_tmp$x##2412" | $k_##2411} -&gt; lq_tmp$x##2444:{VV##2423 : ({VV##2413 : t^"lq_tmp$x##2415" | $k_##2414[a##a1qt:=lq_tmp$x##2443]}, {VV##2416 : GHC.Types.Int^"lq_tmp$x##2418" | $k_##2417[a##a1qt:=lq_tmp$x##2443]})^"lq_tmp$x##2425" | $k_##2424[a##a1qt:=lq_tmp$x##2443]} -&gt; lq_tmp$x##2445:{VV##2426 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2428" | $k_##2427[ds_d1RN:=lq_tmp$x##2444][a##a1qt:=lq_tmp$x##2443]} -&gt; {VV##2439 : ({VV##2429 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2431" | $k_##2430[ds_d1RN:=lq_tmp$x##2444][ds_d1RO:=lq_tmp$x##2445][a##a1qt:=lq_tmp$x##2443]}, {VV##2432 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2434" | $k_##2433[ds_d1RN:=lq_tmp$x##2444][ds_d1RO:=lq_tmp$x##2445][a##a1qt:=lq_tmp$x##2443]})^"lq_tmp$x##2441" | $k_##2440[ds_d1RN:=lq_tmp$x##2444][ds_d1RO:=lq_tmp$x##2445][a##a1qt:=lq_tmp$x##2443]}</span><span class='hs-varid'>loop</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2837 : GHC.Types.Int^"lq_tmp$x##2836" | lq_tmp$x##2837 == a##a1qt + y##a1qB}</span><span class='hs-varid'>a</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##2834:GHC.Types.Int -&gt; lq_tmp$x##2835:GHC.Types.Int -&gt; {lq_tmp$x##2837 : GHC.Types.Int^"lq_tmp$x##2836" | lq_tmp$x##2837 == lq_tmp$x##2834 + lq_tmp$x##2835}</span><span class='hs-varop'>+</span></a><span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : t^"lq_tmp$x##2862" | VV == l##a1qu - lq_anf$##1677728872##d1Ti}</span><span class='hs-varid'>l</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##2860:t -&gt; lq_tmp$x##2861:t -&gt; {VV : t^"lq_tmp$x##2862" | VV == lq_tmp$x##2860 - lq_tmp$x##2861}</span><span class='hs-comment'>-</span></a><a class=annot href="#"><span class=annottext>{VV : t^"lq_tmp$x##2851" | VV == lq_anf$##1677728871##d1Th}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2890 : lq_tmp$x##2891:GHC.Types.Int -&gt; lq_tmp$x##2892:Data.ByteString.Internal.ByteString -&gt; {lq_tmp$x##2888 : Data.ByteString.Internal.ByteString | (lq_tmp$x##2891 &lt;= 0 &lt;=&gt; bslen lq_tmp$x##2888 == bslen lq_tmp$x##2892)
                                                                                                                                                                &amp;&amp; (0 &lt;= lq_tmp$x##2891
                                                                                                                                                                    &amp;&amp; lq_tmp$x##2891 &lt;= bslen lq_tmp$x##2892 &lt;=&gt; bslen lq_tmp$x##2888 == bslen lq_tmp$x##2892 - lq_tmp$x##2891)
                                                                                                                                                                &amp;&amp; (bslen lq_tmp$x##2892 &lt;= lq_tmp$x##2891 &lt;=&gt; bslen lq_tmp$x##2888 == 0)} | lq_tmp$x##2890 == Data.ByteString.drop##r7R}</span><span class='hs-conid'>B</span></a><span class='hs-varop'>.</span><span class='hs-varid'>drop</span> <span class='hs-varid'>y</span> <span class='hs-varid'>bs1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>112: </span>                                          <span class='hs-keyword'>_</span>    <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2443:{VV##2410 : GHC.Types.Int^"lq_tmp$x##2412" | $k_##2411} -&gt; lq_tmp$x##2444:{VV##2423 : ({VV##2413 : t^"lq_tmp$x##2415" | $k_##2414[a##a1qt:=lq_tmp$x##2443]}, {VV##2416 : GHC.Types.Int^"lq_tmp$x##2418" | $k_##2417[a##a1qt:=lq_tmp$x##2443]})^"lq_tmp$x##2425" | $k_##2424[a##a1qt:=lq_tmp$x##2443]} -&gt; lq_tmp$x##2445:{VV##2426 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2428" | $k_##2427[ds_d1RN:=lq_tmp$x##2444][a##a1qt:=lq_tmp$x##2443]} -&gt; {VV##2439 : ({VV##2429 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2431" | $k_##2430[ds_d1RN:=lq_tmp$x##2444][ds_d1RO:=lq_tmp$x##2445][a##a1qt:=lq_tmp$x##2443]}, {VV##2432 : Data.ByteString.Internal.ByteString^"lq_tmp$x##2434" | $k_##2433[ds_d1RN:=lq_tmp$x##2444][ds_d1RO:=lq_tmp$x##2445][a##a1qt:=lq_tmp$x##2443]})^"lq_tmp$x##2441" | $k_##2440[ds_d1RN:=lq_tmp$x##2444][ds_d1RO:=lq_tmp$x##2445][a##a1qt:=lq_tmp$x##2443]}</span><span class='hs-varid'>loop</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2742 : GHC.Types.Int^"lq_tmp$x##2741" | lq_tmp$x##2742 == a##a1qt + y##a1qB}</span><span class='hs-varid'>a</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##2739:GHC.Types.Int -&gt; lq_tmp$x##2740:GHC.Types.Int -&gt; {lq_tmp$x##2742 : GHC.Types.Int^"lq_tmp$x##2741" | lq_tmp$x##2742 == lq_tmp$x##2739 + lq_tmp$x##2740}</span><span class='hs-varop'>+</span></a><span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2762 : GHC.Types.Int^"lq_tmp$x##2761" | lq_tmp$x##2762 == c##a1qv - lq_anf$##1677728866##d1Tc}</span><span class='hs-varid'>c</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##2759:GHC.Types.Int -&gt; lq_tmp$x##2760:GHC.Types.Int -&gt; {lq_tmp$x##2762 : GHC.Types.Int^"lq_tmp$x##2761" | lq_tmp$x##2762 == lq_tmp$x##2759 - lq_tmp$x##2760}</span><span class='hs-comment'>-</span></a><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2793 : lq_tmp$x##2794:GHC.Types.Int -&gt; lq_tmp$x##2795:Data.ByteString.Internal.ByteString -&gt; {lq_tmp$x##2791 : Data.ByteString.Internal.ByteString | (lq_tmp$x##2794 &lt;= 0 &lt;=&gt; bslen lq_tmp$x##2791 == bslen lq_tmp$x##2795)
                                                                                                                                                                &amp;&amp; (0 &lt;= lq_tmp$x##2794
                                                                                                                                                                    &amp;&amp; lq_tmp$x##2794 &lt;= bslen lq_tmp$x##2795 &lt;=&gt; bslen lq_tmp$x##2791 == bslen lq_tmp$x##2795 - lq_tmp$x##2794)
                                                                                                                                                                &amp;&amp; (bslen lq_tmp$x##2795 &lt;= lq_tmp$x##2794 &lt;=&gt; bslen lq_tmp$x##2791 == 0)} | lq_tmp$x##2793 == Data.ByteString.drop##r7R}</span><span class='hs-conid'>B</span></a><span class='hs-varop'>.</span><span class='hs-varid'>drop</span> <span class='hs-varid'>y</span> <span class='hs-varid'>bs1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>113: </span>                         <span class='hs-conid'>Nothing</span>    <span class='hs-keyglyph'>-&gt;</span>  <span class='hs-layout'>(</span><span class='hs-varid'>bs</span><span class='hs-layout'>,</span> <span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-varid'>empty</span><span class='hs-layout'>)</span>
<span class=hs-linenum>114: </span>
<span class=hs-linenum>115: </span>
<span class=hs-linenum>116: </span><span class='hs-comment'>-- lineOffset :: Int -&gt; ByteString -&gt; Int</span>
<span class=hs-linenum>117: </span><span class='hs-comment'>-- lineOffset l bs = snd $ foldlUntil f endCond (l, 0) bs</span>
<span class=hs-linenum>118: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>119: </span><span class='hs-comment'>-- endCond :: (Int, Int) -&gt; Bool</span>
<span class=hs-linenum>120: </span><span class='hs-comment'>-- endCond (line, _) = line &lt; 1</span>
<span class=hs-linenum>121: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>122: </span><span class='hs-comment'>-- f :: (Int, Int) -&gt; Char -&gt; (Int, Int)</span>
<span class=hs-linenum>123: </span><span class='hs-comment'>-- f (l, offset) ch</span>
<span class=hs-linenum>124: </span><span class='hs-comment'>--   | l == 0     = (0, offset)</span>
<span class=hs-linenum>125: </span><span class='hs-comment'>--   | ch == '\n' = (l - 1, offset + 1)</span>
<span class=hs-linenum>126: </span><span class='hs-comment'>--   | otherwise  = (l, offset + 1)</span>
<span class=hs-linenum>127: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>128: </span><span class='hs-comment'>-- -- foldl with early opt-out</span>
<span class=hs-linenum>129: </span><span class='hs-comment'>-- foldlUntil :: (a -&gt; Char -&gt; a) -&gt; (a -&gt; Bool) -&gt; a -&gt; B.ByteString -&gt; a</span>
<span class=hs-linenum>130: </span><span class='hs-comment'>-- foldlUntil add optOut acc cs  = case uncons cs of</span>
<span class=hs-linenum>131: </span><span class='hs-comment'>--                       Just (a,as) -&gt; let v = add acc a</span>
<span class=hs-linenum>132: </span><span class='hs-comment'>--                                      in seq v $ if optOut v</span>
<span class=hs-linenum>133: </span><span class='hs-comment'>--                                                 then acc</span>
<span class=hs-linenum>134: </span><span class='hs-comment'>--                                                 else foldl add v as</span>
<span class=hs-linenum>135: </span><span class='hs-comment'>--                       Nothing     -&gt; acc</span>
<span class=hs-linenum>136: </span>
<span class=hs-linenum>137: </span>
<span class=hs-linenum>138: </span>
<span class=hs-linenum>139: </span><span class='hs-comment'>-- spanLines :: Advancement -&gt; ByteString -&gt; (ByteString, ByteString)</span>
<span class=hs-linenum>140: </span><span class='hs-comment'>-- spanLines (l, c) input =</span>
<span class=hs-linenum>141: </span><span class='hs-comment'>--   if l == 0 then</span>
<span class=hs-linenum>142: </span><span class='hs-comment'>--     splitAt c input</span>
<span class=hs-linenum>143: </span><span class='hs-comment'>--   else</span>
<span class=hs-linenum>144: </span><span class='hs-comment'>--     let (output, outputTail) = spans (mempty, input)</span>
<span class=hs-linenum>145: </span><span class='hs-comment'>--         (lastOutput, tailOutput) = splitAt (c - 1) outputTail</span>
<span class=hs-linenum>146: </span><span class='hs-comment'>--     in (output &lt;&gt; lastOutput, tailOutput)</span>
<span class=hs-linenum>147: </span><span class='hs-comment'>--     where</span>
<span class=hs-linenum>148: </span><span class='hs-comment'>--       spans = foldr (.) id (replicate l breakLines)</span>
<span class=hs-linenum>149: </span><span class='hs-comment'>--       breakLines (acc, bs) =</span>
<span class=hs-linenum>150: </span><span class='hs-comment'>--         let (linePart, bsTail) = break (== '\n') bs</span>
<span class=hs-linenum>151: </span><span class='hs-comment'>--             (lp, lt) = trace ("break " ++ show (linePart, bsTail)) (linePart, bsTail)</span>
<span class=hs-linenum>152: </span><span class='hs-comment'>--         in (acc &lt;&gt; lp &lt;&gt; take 1 lt, drop 1 lt)</span>
<span class=hs-linenum>153: </span>
</pre>
</body>
</html>